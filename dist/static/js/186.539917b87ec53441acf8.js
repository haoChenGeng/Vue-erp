webpackJsonp([186,269],{5:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var d=r(a(1)),n=r(a(8));t.default={allSystemCodeList:function(e){return(0,d.default)({method:n.default.CONFIGURE.methods.SYS_CODE_LIST,service:n.default.CONFIGURE.name,args:e})},listNextLevelUnforbidden:function(e){return(0,d.default)({method:n.default.CONFIGURE.methods.LIST_UNFORBIDDEN,service:n.default.CONFIGURE.name,args:e})},queryUnionParent:function(e){return(0,d.default)({method:n.default.SUPPLY_CONFIGURE.methods.queryUnionParent,service:n.default.SUPPLY_CONFIGURE.name,args:e})},queryPage:function(e){return(0,d.default)({method:n.default.SUPPLY_CONFIGURE.methods.QUERY_PAGE,service:n.default.SUPPLY_CONFIGURE.name,args:e})},queryShopUnion:function(e){return(0,d.default)({method:n.default.SUPPLY_CONFIGURE.methods.queryShopUnion,service:n.default.SUPPLY_CONFIGURE.name,args:e})},queryShop:function(e){return(0,d.default)({method:n.default.SUPPLY_CONFIGURE.methods.queryShop,service:n.default.SUPPLY_CONFIGURE.name,args:e})},queryByFunctionCode:function(e){return(0,d.default)({method:n.default.ORGANIZATION.methods.QUERY_BY_FUNCTIONCODE,service:n.default.ORGANIZATION.name,args:e})},queryAll:function(e){return(0,d.default)({method:n.default.ORGANIZATION.methods.ORG_QUERY,service:n.default.ORGANIZATION.name,args:e})},queryTreeByTypeAndFunction:function(e){return(0,d.default)({method:n.default.ORGANIZATION.methods.QUERY_TREE_FUNCTION,service:n.default.ORGANIZATION.name,args:e})},queryChildrenByWholeCode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return(0,d.default)({method:n.default.SUPPLY_CONFIGURE.methods.queryChildrenByWholeCode,service:n.default.SUPPLY_CONFIGURE.name,args:{wholeCode:e,depth:t}})},queryChildrenByWholeCodes:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return(0,d.default)({method:n.default.SUPPLY_CONFIGURE.methods.queryChildrenByWholeCodes,service:n.default.SUPPLY_CONFIGURE.name,args:{wholeCodes:e,depth:t}})},getAllQueue:function(){return(0,d.default)({method:n.default.EDA.methods.QUERY_QUEUE_QUERYQUEUES,service:n.default.EDA.name,args:{}})}}},8:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={CONFIGURE:{name:"OnLYil9jY0PiKilsavskNJvygGUxhME7eLPWccmGmYjb_ED",methods:{SYS_CODE_LIST:"vPnFi_QA4HeBWeU61ZjQPCn",LIST_UNFORBIDDEN:"vL0y_oFhAeDM3YTmFrp2oaHn1UDcQEzq1orWi41sEc2pVcjlpGN"}},SUPPLY_CONFIGURE:{name:"qVq5B_KUuBzTC3kyP9TiuA53IS1kiBn5fR5JVjR7fUS6nsTm4Zc",methods:{QUERY_PAGE:"Ewi6YId8aELgLHFBBSBMT4BvG3R",queryUnionParent:"5l6jR2KUJ4QdYxLFz0ZJGFy5XZkLajNNSEdLf0t",queryShopUnion:"zPrIoMCwO3geMqwnGH2Afs0w-7lpdva",queryShop:"4VE-APqV_Fs13Cswfj8",queryChildrenByWholeCode:"sDE1BauR-rhu_AU-6F9VF952lJ_JIl-r1QOnscFpFYW0GFS9p3nAG1z",queryChildrenByWholeCodes:"CEGKxWt_AJmoqBtXoGEqET64657I2n7n39qadM-E_uX2b1O8X5k8Ii2vEnj"}},ORGANIZATION:{name:"CsxicaQ7wM_3kaiMdGJQAaOa2fUF8v-",methods:{QUERY_BY_FUNCTIONCODE:"UwBgld0zWv.T_KSfK6W2_uSPCGXiv-mkEbmTNx6qeGoR_hH",ORG_QUERY:"DOiN6_9fU1yNwZE_gRuTrdwwvEg",QUERY_TREE_FUNCTION:"-DB0-GqPoWXHozK4BKUV3yMPaFmC4lppJyYYIe9k-Gk5VCj84OEe2JBi24SnYuFqXHe",ORG_QUERY_WITHOUTDEL:"9Ivp3_1e5zNZU_miVqa6YXq9Zg0sb1JBadatp4EuTiR"}},GOODS:{name:"qVq5B_KUuBzTC3kyP9TiuA53IS1kiBn5fR5JVjR7fUS6nsTm4Zc",methods:{QUERY_PAGE:"ByoqRxHfrD8M7MGSNKC-qVN",QUERY_PAGE_GOODS_UNION:"KYI9tvUKvrmrnw02TOmUAbkj27FmFOkq8nDox-O"}},EDA:{name:"806ndPAX4QHSaL8S3kOGYVWD7gJKERC",methods:{QUERY_QUEUE_QUERYQUEUES:"NJaG8pAbK6IGAM2RtOG2V_cGwPKCj8.QKtj"}}}},9:function(e,t,a){e.exports=a(7)(105)},13:function(e,t,a){"use strict";function r(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e}Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){return e&&e.__esModule?e:{default:e}}(a(9)),n=function(){var e=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZWN]|'[^']*'|'[^']*'/g,t=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,a=/[^-+\dA-Z]/g;return function(o,i,s,u){if(1!==arguments.length||"string"!==function(e){return null===e?"null":void 0===e?"undefined":"object"!==(void 0===e?"undefined":(0,d.default)(e))?void 0===e?"undefined":(0,d.default)(e):Array.isArray(e)?"array":{}.toString.call(e).slice(8,-1).toLowerCase()}(o)||/\d/.test(o)||(i=o,o=void 0),(o=o||new Date)instanceof Date||(o=new Date(o)),isNaN(o))throw TypeError("Invalid date");var l=(i=String(n.masks[i]||i||n.masks.default)).slice(0,4);"UTC:"!==l&&"GMT:"!==l||(i=i.slice(4),s=!0,"GMT:"===l&&(u=!0));var f=s?"getUTC":"get",m=o[f+"Date"](),c=o[f+"Day"](),p=o[f+"Month"](),y=o[f+"FullYear"](),h=o[f+"Hours"](),g=o[f+"Minutes"](),v=o[f+"Seconds"](),b=o[f+"Milliseconds"](),O=s?0:o.getTimezoneOffset(),C=function(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);var a=new Date(t.getFullYear(),0,4);a.setDate(a.getDate()-(a.getDay()+6)%7+3);var r=t.getTimezoneOffset()-a.getTimezoneOffset();t.setHours(t.getHours()-r);var d=(t-a)/6048e5;return 1+Math.floor(d)}(o),T=function(e){var t=e.getDay();return 0===t&&(t=7),t}(o),_={d:m,dd:r(m),ddd:n.i18n.dayNames[c],dddd:n.i18n.dayNames[c+7],m:p+1,mm:r(p+1),mmm:n.i18n.monthNames[p],mmmm:n.i18n.monthNames[p+12],yy:String(y).slice(2),yyyy:y,h:h%12||12,hh:r(h%12||12),H:h,HH:r(h),M:g,MM:r(g),s:v,ss:r(v),l:r(b,3),L:r(Math.round(b/10)),t:h<12?"a":"p",tt:h<12?"am":"pm",T:h<12?"A":"P",TT:h<12?"AM":"PM",Z:u?"GMT":s?"UTC":(String(o).match(t)||[""]).pop().replace(a,""),o:(O>0?"-":"+")+r(100*Math.floor(Math.abs(O)/60)+Math.abs(O)%60,4),S:["th","st","nd","rd"][m%10>3?0:(m%100-m%10!=10)*m%10],W:C,N:T};return i.replace(e,function(e){return e in _?_[e]:e.slice(1,e.length-1)})}}();n.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},n.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},t.default=n},247:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={ORGANIZATION:{name:"sZtRu1cUhrxUCb3Xs9rEF7UWlxvmgWT",methods:{queryTreeByType:"Ch9v97-QSI8xfvtmUjsMbcKD9fc9eyPvA0OswLI-mnq"}},refundOrder:{name:"VqBhmkux_Up8X5gMW3lMq3_u92o0LEG",methods:{refundOrderCreate:"AYYWRbE-fTK4IANyJMo7GHLK5i8p6c286zI",refundOrderCancel:"KSO_2di1Uy8vKHDl7-OjRFHAiH-MrE4uQ5W",refundOrderReject:"ipop_tHhzf4W3vpL5VHapcaM-s7atrEXceG",refundOrderComplete:"lbVtgrNhjpsFsjH4ZjE79sOHQxKM3w0f23rOFTx",refundOrderQueryPage:"NVSU5i6OJTRza7Cq6WDn9uUIE3KHF1SHFZuEHPV",refundOrderProjectDetail:"64JIsUuNvJ1V1s3I1wYsBr7r95poC9Gk4y-TgiC-pi7_jPd",refundOrderFindById:"n3fyXwW7nievixZhL2vdIGuqRVoSwy5VRU1dTbK",refundOrderItemQueryPage:"AVBfYeEuFoELINDR1d6eCISKCwU_PVwasbUTuCg7_pgMJn3",queryByDemandOrderCode:"2_8AzCpJj-zu6KtNPQ_c-V9yukfojw0jFNSwukCXz-dwxLs4BYn6uu8z_W2lftX",queryByRefundOrderCode:"hnbbj-RzktYtlfrmcT-MoaN_PkLa1uSqM9iJL5XqpTPMf8grGZWftZuOmN2cKV2",queryPageForChooseDemandOrderCode:"_4KFDXyRA68t3D6f20epGr8oU894JwO2288vG4GfE1WHPB4ax54X7RL-oaLzZbJ59pp-alM"}}}},248:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var d=r(a(1)),n=r(a(247));t.default={queryTreeByType:function(e){return(0,d.default)({method:n.default.ORGANIZATION.methods.queryTreeByType,service:n.default.ORGANIZATION.name,args:e})},refundOrderCreate:function(e){return(0,d.default)({method:n.default.refundOrder.methods.refundOrderCreate,service:n.default.refundOrder.name,args:e})},refundOrderCancel:function(e){return(0,d.default)({method:n.default.refundOrder.methods.refundOrderCancel,service:n.default.refundOrder.name,args:e})},refundOrderReject:function(e){return(0,d.default)({method:n.default.refundOrder.methods.refundOrderReject,service:n.default.refundOrder.name,args:e})},refundOrderComplete:function(e){return(0,d.default)({method:n.default.refundOrder.methods.refundOrderComplete,service:n.default.refundOrder.name,args:e})},refundOrderQueryPage:function(e){return(0,d.default)({method:n.default.refundOrder.methods.refundOrderQueryPage,service:n.default.refundOrder.name,args:e})},refundOrderItemQueryPage:function(e){return(0,d.default)({method:n.default.refundOrder.methods.refundOrderItemQueryPage,service:n.default.refundOrder.name,args:e})},refundOrderProjectDetail:function(e){return(0,d.default)({method:n.default.refundOrder.methods.refundOrderProjectDetail,service:n.default.refundOrder.name,args:e})},refundOrderFindById:function(e){return(0,d.default)({method:n.default.refundOrder.methods.refundOrderFindById,service:n.default.refundOrder.name,args:e})},queryByDemandOrderCode:function(e){return(0,d.default)({method:n.default.refundOrder.methods.queryByDemandOrderCode,service:n.default.refundOrder.name,args:e})},queryByRefundOrderCode:function(e){return(0,d.default)({method:n.default.refundOrder.methods.queryByRefundOrderCode,service:n.default.refundOrder.name,args:e})},queryPageForChooseDemandOrderCode:function(e){return(0,d.default)({method:n.default.refundOrder.methods.queryPageForChooseDemandOrderCode,service:n.default.refundOrder.name,args:e})}}},542:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var d,n=r(a(13)),o=r(a(5)),i=r(a(248)),s=r(a(20)),u=r(a(6)),l=[];t.default={name:"t8t-dt-view",data:function(){return{uploadURL:s.default.getUploadURL(),id:null,mode:"",dataSource:{id:null,refundOrderCode:null,demandOrderCode:null,projectId:null,status:null,refundTime:null,cancelReason:null,orgId:null,scheduleNodeId:null,address:null,ownerName:null,pmName:null,designerName:null,createName:null,createBy:null,createTime:null,updateName:null,updateBy:null,updateTime:null,orgName:null,scheduleNodeName:null},options:{status:[],status1:[{value:1,text:"退货中"},{value:2,text:"已撤销"},{value:3,text:"已关闭"}],status2:[{value:1,text:"退货中"},{value:2,text:"已撤销"},{value:3,text:"已驳回"},{value:4,text:"已完成"}]},isTopHide:!1,isDialogShow:!0,subActiveTab:"refundOrderItem",goBackRoute:"/delivery/refundOrder-index",item:{name:"demandOrderCode",disabled:!0,textValue:"demandOrderCode",filedValue:"demandOrderCode",defaultValue:null,dialog:{title:"选择要货单",size:"large",dialogWidth:"900px",searchForm:{fields:[{type:"input",label:"要货单号",name:"demandOrderCode"},{type:"input",label:"项目ID",name:"projectId"}],resetBtnVisible:!0,showToggleBtn:!1},table:{columns:[{prop:"demandOrderCode",label:"要货单号"},{prop:"statusText",label:"状态"},{prop:"projectId",label:"项目ID"},{prop:"demandTime",label:"下单时间",formatter:function(e){return(0,n.default)(1e3*e,"yyyy-mm-dd HH:MM:ss")}},{prop:"materialType",label:"材料类型",list:"status"}],commonData:{status:[{value:1,text:"主材"},{value:2,text:"辅材"}]},service:"VqBhmkux_Up8X5gMW3lMq3_u92o0LEG",method:"_4KFDXyRA68t3D6f20epGr8oU894JwO2288vG4GfE1WHPB4ax54X7RL-oaLzZbJ59pp-alM",args:{},radioCol:!0,selectable:function(e){return 1==e.status||2==e.status||0==e.status}},onBeforeConfirm:function(e){var t=e[0];return 1==t.status||2==t.status||0==t.status}}},symbolList:[""],disabledSymbols:[],isUploadShow:!0,isUpload:!1,galleryVisible:!1,fileList:[],galleryData:[],__id:null,autosize:{minRows:2},selectSource:[]}},mounted:function(){var e=this;this.$nextTick(function(){e.mode=e.$route.query.mode||"add","add"===e.mode&&(e.symbolList=["EDIT-SUBMIT"],e.item.disabled=!1,e.getCommonOptions().then(function(){e.initAddTreeTable()})),"view"===e.mode&&(e.symbolList=[""],e.initViewMainTable(),e.getCommonOptions().then(function(){e.initViewSubTable()}))})},destroyed:function(){$("#refund-table").off()},watch:{"dataSource.demandOrderCode":function(e){"add"===this.mode&&(this.initAddMainTable(e),this.initAddSubTable(e))}},methods:{onTopHide:function(){this.isTopHide=!this.isTopHide},initViewMainTable:function(){var e=this;i.default.refundOrderFindById({id:this.$route.query.id}).then(function(t){200===t.data.status&&t.data.result&&(e.dataSource=t.data.result,e.item.defaultValue={textValue:t.data.result.demandOrderCode,filedValue:t.data.result.demandOrderCode})})},initViewSubTable:function(){var e=this;i.default.queryByRefundOrderCode({refundOrderCode:this.$route.query.refundOrderCode}).then(function(e){200===e.data.status&&e.data.result&&(l=e.data.result)}).then(function(){e.initViewTreeTable()})},initAddMainTable:function(e){var t=this;i.default.refundOrderProjectDetail({demandOrderCode:e}).then(function(e){200===e.data.status&&e.data.result&&(t.dataSource.address=e.data.result.address,t.dataSource.designerName=e.data.result.designerName,t.dataSource.ownerName=e.data.result.ownerName,t.dataSource.pmName=e.data.result.pmName,t.dataSource.projectId=e.data.result.projectId)})},initAddSubTable:function(e){i.default.queryByDemandOrderCode({demandOrderCode:e}).then(function(e){if(200===e.data.status&&e.data.result){!function e(t,a){(t.items||[]).forEach(function(t){t.refundReasonType="",e(t)})}({items:l=e.data.result})}}).then(function(){d.set("data",{Rows:l})})},closeDialog:function(){this.$router.push({path:this.goBackRoute}),this.$emit("close")},initAddTreeTable:function(){function e(e){return 0===d.getRow(e).maxRefundableNum}var t=this;d=$("#refund-table").ligerGrid({columns:[{display:"商品编码",name:"goodsCode",id:"index",align:"left"},{display:"商品名称",name:"goodsName"},{display:"单位",name:"basicUnitName"},{display:"最大可退数量",name:"maxRefundableNum",render:function(e){return e.isBom?"":e.maxRefundableNum}},{display:"退货数量",name:"refundNum",editor:{type:"int"},type:"int",render:function(e){return e.isBom?"":0==e.maxRefundableNum?'<span class="g-placeholder">不可退</span>':0==e.refundNum?'<span class="g-placeholder">请输入退货数量</span>':e.refundNum}},{display:"退货原因",name:"refundReasonType",editor:{type:"select",data:t.options.status,valueField:"value",textField:"text",onChange:function(e){function t(e,a){(e.items||[]).forEach(function(e){e.refundReasonType=a,t(e)})}e.selected&&t(e.record,e.value)}},render:function(e){if(e.isBom)return"";if(""==e.refundReasonType)return'<span class="g-placeholder">选择退货原因</span>';for(var a=0;a<t.options.status.length;a++)if(t.options.status[a].value==e.refundReasonType)return t.options.status[a].text;return e.refundReasonType}},{display:"备注",name:"refundRemark",editor:{type:"text"}},{display:"操作",render:function(e){var a=e.__id,r="";return t.isType3(e)&&(r='<button href="javascript:;" data-id="'+a+'" class="my-btn1 el-button el-button--default el-button--mini">上传图片</button><button href="javascript:;" data-id="'+a+'" class="my-btn2 el-button el-button--default el-button--mini">查看图片</button>'),r}}],fixedCellHeight:!1,width:"95%",height:"97%",data:{Rows:[]},tree:{childrenName:"items",columnId:"index"},rownumbers:!0,enabledSort:!1,checkbox:!0,usePager:!1,enabledEdit:!0,onBeforeEdit:function(e){return 0!=e.record.maxRefundableNum&&(!0===e.record.isBom?(t.$message("bom数据！"),!1):d.isSelected(e.rowindex)?"refundNum"!=e.column.name||"refundNum"!=e.column.name||!t.isType2(e.record):(t.$message("勾选后编辑！"),!1))}}),$("#refund-table").on("click",".my-btn1",function(){var a=$(this).data("id");return!e(a)&&(d.isSelected(a)?void t.showUpload(a):t.$message("勾选后编辑！"))}),$("#refund-table").on("click",".my-btn2",function(){var a=$(this).data("id");return!e(a)&&(d.isSelected(a)?void t.showGallery(a):t.$message("勾选后编辑！"))})},initViewTreeTable:function(){var e=this;d=$("#refund-table").ligerGrid({columns:[{display:"商品编码",name:"goodsCode",id:"index",align:"left"},{display:"商品名称",name:"goodsName"},{display:"单位",name:"basicUnitName"},{display:"实际退货数量",name:"actualRefundNum"},{display:"退货数量",name:"refundNum"},{display:"退货状态",name:"status",render:function(t){for(var a=0;a<e.options.status2.length;a++)if(e.options.status2[a].value==t.status)return e.options.status2[a].text;return t.status}},{display:"退货原因",name:"refundReasonType",editor:{type:"select",data:e.options.status,valueField:"value",textField:"text"},render:function(t){if(""==t.refundReasonType)return'<span class="g-placeholder">选择退货原因</span>';for(var a=0;a<e.options.status.length;a++)if(e.options.status[a].value==t.refundReasonType)return e.options.status[a].text;return t.refundReasonType}},{display:"备注",name:"refundRemark",render:function(e){return'<span title="'+e.refundRemark+'">'+e.refundRemark+"</span>"}},{display:"操作",render:function(e){var t=e.__id,a="";return e.imageUrlList&&(a='<button href="javascript:;" data-id="'+t+'" class="my-btn3 el-button el-button--default el-button--mini">查看图片</button>'),a}}],width:"95%",height:"100%",data:{Rows:l},tree:{childrenName:"items",columnId:"index"},rownumbers:!0,enabledSort:!1,checkbox:!1,usePager:!1,pageSize:20,enabledEdit:!0}),$("#refund-table").on("click",".my-btn3",function(){var t=$(this).data("id");e.showGallery(t)})},onChange:function(e){this.dataSource.demandOrderCode=e},showUpload:function(e){this.__id=e;var t=d.getRow(this.__id);this.fileList=t.fileList||[],this.isUploadShow=!0,this.isUpload=!0},closeUpload:function(){this.isUpload=!1,this.__id=null,this.fileList=[]},saveUpload:function(){if(this.fileList.length>9)return this.$message("最多上传9张图片");var e=d.getRow(this.__id);e.fileList=this.fileList;var t=[];this.fileList.forEach(function(e){t.push(e.response.result.filePath)}),e.imageUrlList=t,this.$message("图片已保存"),this.closeUpload()},showGallery:function(e){var t=this,a=[];if(d.getRow(e).imageUrlList.forEach(function(e){var t=s.default.getFullURL(e);a.push({src:t})}),this.galleryData=a,0===this.galleryData.length)return this.$message("没有图片！");this.$nextTick(function(){t.galleryVisible=!0})},onRemove:function(e,t){this.fileList=t},onSuccess:function(e,t,a){200===e.status&&(this.fileList=a)},onsubmit:function(){if(d){var e=d.getSelectedRows();0!=e.length?this.validRows(e)&&this.sendData(e):this.$message("请勾选数据！")}},validRows:function(e){var t=!0;return e.forEach(function(e){e.refundNum>e.maxRefundableNum&&(t=!1,d.addErrorByName(e,"refundNum","多于最大可退数量")),e.refundNum<=0&&(t=!1,d.addErrorByName(e,"refundNum","请填写正确退货数量")),e.refundReasonType||(t=!1,d.addErrorByName(e,"refundReasonType","选择退货原因")),"07"!=e.refundReasonType||e.refundRemark||(t=!1,d.addErrorByName(e,"refundRemark","请填写备注"))}),t},sendData:function(e){var t=this;this.disabledSymbols=["EDIT-SUBMIT"];var a=[];e.forEach(function(e){var t={refundNum:e.refundNum,refundReasonType:+e.refundReasonType,refundRemark:e.refundRemark,imageUrlList:e.imageUrlList,goodsId:e.goodsId,goodsType:e.goodsType,demandItemParentId:e.demandItemParentId,demandItemId:e.demandItemId};a.push(t)});var r={refundOrder:{demandOrderCode:this.dataSource.demandOrderCode,createUser:+u.default.get("t8t-tc-uid"),refundOrderItemCreateDTOList:a}};i.default.refundOrderCreate(r).then(function(e){t.disabledSymbols=[],200===e.data.status?t.closeDialog():41600===e.data.status?t.$message.error("要货单状态错误"):41601===e.data.status?t.$message.error("获取退货单依赖数据失败"):41602===e.data.status?t.$message.error("退货商品找不到对应的要货项"):41603===e.data.status?t.$message.error("退货商品数量超过要货商品的可退数量"):t.$message.error(e.data.message)})},getCommonOptions:function(){var e=this,t=[];return o.default.queryUnionParent({page:1,search:{pPropertyCode:"11609"},size:100}).then(function(a){200===a.data.status&&(a.data.result.forEach(function(e){1===e.propertyStatus&&t.push({value:e.propertyCode,text:e.propertyName})}),e.options.status=t)})},isType1:function(e){return 1==e.isNormative&&1==e.goodsType},isType2:function(e){return 0==e.isNormative&&1==e.goodsType},isType3:function(e){return 2==e.goodsType||(void 0==e.items||0==e.items.length)},isBom:function(e){return e.isBom},onBeforeUpload:function(e){if(this.fileList.length>=9)return this.$message("最多上传9张图片"),!1}}}},1101:function(e,t,a){(e.exports=a(2)()).push([e.id,"\n.my-btn {\n    margin: 5px;\n}\n.refundOrder-upload {\n    width: 315px;\n    margin: 0 auto;\n}\n",""])},1102:function(e,t,a){(e.exports=a(2)()).push([e.id,"\n.dialog2-main-container.isHide .full-dialog-form-container[data-v-3e550b62] {\n    display: none;\n}\n#refund-table[data-v-3e550b62] {\n    margin: 0 auto;\n}\n.refundTime[data-v-3e550b62] {\n    width: 180px;\n    height: 32px;\n    background-color: #eef1f6;\n    border-color: #d1dbe5;\n    color: #bbb;\n    cursor: not-allowed;\n    border-radius: 2px;\n    border: 1px solid #bfcbd9;\n    box-sizing: border-box;\n    padding: 0 10px;\n}\n",""])},1547:function(e,t,a){var r=a(1101);"string"==typeof r&&(r=[[e.id,r,""]]);a(3)(r,{});r.locals&&(e.exports=r.locals)},1548:function(e,t,a){var r=a(1102);"string"==typeof r&&(r=[[e.id,r,""]]);a(3)(r,{});r.locals&&(e.exports=r.locals)},1986:function(e,t,a){a(1548),a(1547);var r=a(4)(a(542),a(2380),"data-v-3e550b62",null);e.exports=r.exports},2380:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"t8t-detail-view"},[a("el-dialog",{staticClass:"t8t-full-dialog2",attrs:{size:"full"},on:{close:e.closeDialog},model:{value:e.isDialogShow,callback:function(t){e.isDialogShow=t}}},[a("div",{staticClass:"t8t-full-dialog2-container"},[a("div",{staticClass:"full-dialog-toolbar-container"},[a("div",{staticClass:"toolbar-container"},[a("t8t-toolbar",{staticClass:"t8t-dark",attrs:{symbolList:e.symbolList,disabledSymbols:e.disabledSymbols},on:{"EDIT-SUBMIT":function(t){e.onsubmit()}}})],1)]),e._v(" "),a("div",{staticClass:"dialog2-main-container",class:{isHide:e.isTopHide}},[a("div",{staticClass:"toggle-btn-container"},[a("div",{staticClass:"toggle-btn el-icon-d-arrow-left",on:{click:e.onTopHide}})]),e._v(" "),a("div",{staticClass:"full-dialog-form-container"},[a("el-form",{ref:"formRef",staticClass:"dialog2-form-container",attrs:{model:e.dataSource,rules:e.formRule,"label-position":"right","label-width":"120px"}},["view"==e.mode?a("div",{staticClass:"dialog2-form-item-container"},[a("el-form-item",{attrs:{label:"退货单号"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.dataSource.refundOrderCode,callback:function(t){e.dataSource.refundOrderCode=t}}})],1)],1):e._e(),e._v(" "),a("div",{staticClass:"dialog2-form-item-container"},[a("el-form-item",{attrs:{label:"要货单号"}},[a("t8t-form-popup",{attrs:{defaultValue:e.item.defaultValue,textValue:e.item.textValue,filedValue:e.item.filedValue,disabled:e.item.disabled,dialog:e.item.dialog,readonly:""},on:{change:e.onChange}})],1)],1),e._v(" "),a("div",{staticClass:"dialog2-form-item-container"},[a("el-form-item",{attrs:{label:"项目ID"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.dataSource.projectId,callback:function(t){e.dataSource.projectId=t}}})],1)],1),e._v(" "),"view"==e.mode?a("div",{staticClass:"dialog2-form-item-container"},[a("el-form-item",{attrs:{label:"排期节点"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.dataSource.scheduleNodeName,callback:function(t){e.dataSource.scheduleNodeName=t}}})],1)],1):e._e(),e._v(" "),"view"==e.mode?a("div",{staticClass:"dialog2-form-item-container"},[a("el-form-item",{attrs:{label:"组织"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.dataSource.orgName,callback:function(t){e.dataSource.orgName=t}}})],1)],1):e._e(),e._v(" "),"view"==e.mode?a("div",{staticClass:"dialog2-form-item-container"},[a("el-form-item",{attrs:{label:"单据状态"}},[a("el-select",{attrs:{disabled:!0},model:{value:e.dataSource.status,callback:function(t){e.dataSource.status=t}}},e._l(e.options.status1,function(e){return a("el-option",{attrs:{label:e.text,value:e.value}})}))],1)],1):e._e(),e._v(" "),"view"==e.mode?a("div",{staticClass:"dialog2-form-item-container"},[a("el-form-item",{attrs:{label:"退货人"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.dataSource.createBy,callback:function(t){e.dataSource.createBy=t}}})],1)],1):e._e(),e._v(" "),"view"==e.mode?a("div",{staticClass:"dialog2-form-item-container"},[a("el-form-item",{attrs:{label:"退货完成时间"}},[a("div",{staticClass:"refundTime"},[e._v(e._s(e._f("toDate")(e.dataSource.refundTime)))])])],1):e._e(),e._v(" "),a("div",{staticClass:"dialog2-form-item-container"},[a("el-form-item",{attrs:{label:"项目经理姓名"}},[a("el-input",{attrs:{disabled:!0}})],1)],1),e._v(" "),a("div",{staticClass:"dialog2-form-item-container"},[a("el-form-item",{attrs:{label:"业主姓名"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.dataSource.ownerName,callback:function(t){e.dataSource.ownerName=t}}})],1)],1),e._v(" "),a("div",{staticClass:"dialog2-form-item-container"},[a("el-form-item",{attrs:{label:"设计师姓名"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.dataSource.designerName,callback:function(t){e.dataSource.designerName=t}}})],1)],1),e._v(" "),a("div",{staticClass:"dialog2-form-item-container"},[a("el-form-item",{attrs:{label:"详细地址"}},[a("el-input",{attrs:{type:"textarea",autosize:e.autosize,resize:"none",disabled:!0},model:{value:e.dataSource.address,callback:function(t){e.dataSource.address=t}}})],1)],1),e._v(" "),"view"==e.mode?a("div",{staticClass:"dialog2-form-item-container"},[a("el-form-item",{attrs:{label:"撤销原因"}},[a("el-input",{attrs:{type:"textarea",autosize:e.autosize,resize:"none",disabled:!0},model:{value:e.dataSource.cancelReason,callback:function(t){e.dataSource.cancelReason=t}}})],1)],1):e._e()])],1),e._v(" "),a("div",{staticClass:"full-dialog-tabs-container"},[a("div",{staticClass:"t8t-detail"},[a("el-tabs",{staticClass:"t8t-detail",model:{value:e.subActiveTab,callback:function(t){e.subActiveTab=t}}},[a("el-tab-pane",{attrs:{label:"退货商品",name:"refundOrderItem"}},[a("div",{staticClass:"sub-container"},[a("div",{attrs:{id:"refund-table"}})])])],1)],1)])])])]),e._v(" "),e.isUpload?a("el-dialog",{attrs:{title:"上传图片"},on:{close:e.closeUpload},model:{value:e.isUploadShow,callback:function(t){e.isUploadShow=t}}},[a("el-upload",{staticClass:"refundOrder-upload",attrs:{"list-type":"picture-card",multiple:"",action:e.uploadURL,data:{bucket:"scm",module:"delivery"},"file-list":e.fileList,"on-remove":e.onRemove,"on-success":e.onSuccess,"before-upload":e.onBeforeUpload,accept:"image/gif,image/jpeg,image/jpg,image/png,image/svg"}},[a("i",{staticClass:"el-icon-plus"})]),e._v(" "),a("span",{slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.saveUpload}},[e._v("保 存")]),e._v(" "),a("el-button",{on:{click:e.closeUpload}},[e._v("取 消")])],1)],1):e._e(),e._v(" "),a("t8t-gallery",{attrs:{data:e.galleryData},model:{value:e.galleryVisible,callback:function(t){e.galleryVisible=t}}})],1)},staticRenderFns:[]}}});