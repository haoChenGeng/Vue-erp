webpackJsonp([14,79,269],{5:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=o(a(1)),d=o(a(8));t.default={allSystemCodeList:function(e){return(0,s.default)({method:d.default.CONFIGURE.methods.SYS_CODE_LIST,service:d.default.CONFIGURE.name,args:e})},listNextLevelUnforbidden:function(e){return(0,s.default)({method:d.default.CONFIGURE.methods.LIST_UNFORBIDDEN,service:d.default.CONFIGURE.name,args:e})},queryUnionParent:function(e){return(0,s.default)({method:d.default.SUPPLY_CONFIGURE.methods.queryUnionParent,service:d.default.SUPPLY_CONFIGURE.name,args:e})},queryPage:function(e){return(0,s.default)({method:d.default.SUPPLY_CONFIGURE.methods.QUERY_PAGE,service:d.default.SUPPLY_CONFIGURE.name,args:e})},queryShopUnion:function(e){return(0,s.default)({method:d.default.SUPPLY_CONFIGURE.methods.queryShopUnion,service:d.default.SUPPLY_CONFIGURE.name,args:e})},queryShop:function(e){return(0,s.default)({method:d.default.SUPPLY_CONFIGURE.methods.queryShop,service:d.default.SUPPLY_CONFIGURE.name,args:e})},queryByFunctionCode:function(e){return(0,s.default)({method:d.default.ORGANIZATION.methods.QUERY_BY_FUNCTIONCODE,service:d.default.ORGANIZATION.name,args:e})},queryAll:function(e){return(0,s.default)({method:d.default.ORGANIZATION.methods.ORG_QUERY,service:d.default.ORGANIZATION.name,args:e})},queryTreeByTypeAndFunction:function(e){return(0,s.default)({method:d.default.ORGANIZATION.methods.QUERY_TREE_FUNCTION,service:d.default.ORGANIZATION.name,args:e})},queryChildrenByWholeCode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return(0,s.default)({method:d.default.SUPPLY_CONFIGURE.methods.queryChildrenByWholeCode,service:d.default.SUPPLY_CONFIGURE.name,args:{wholeCode:e,depth:t}})},queryChildrenByWholeCodes:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return(0,s.default)({method:d.default.SUPPLY_CONFIGURE.methods.queryChildrenByWholeCodes,service:d.default.SUPPLY_CONFIGURE.name,args:{wholeCodes:e,depth:t}})},getAllQueue:function(){return(0,s.default)({method:d.default.EDA.methods.QUERY_QUEUE_QUERYQUEUES,service:d.default.EDA.name,args:{}})}}},8:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={CONFIGURE:{name:"OnLYil9jY0PiKilsavskNJvygGUxhME7eLPWccmGmYjb_ED",methods:{SYS_CODE_LIST:"vPnFi_QA4HeBWeU61ZjQPCn",LIST_UNFORBIDDEN:"vL0y_oFhAeDM3YTmFrp2oaHn1UDcQEzq1orWi41sEc2pVcjlpGN"}},SUPPLY_CONFIGURE:{name:"qVq5B_KUuBzTC3kyP9TiuA53IS1kiBn5fR5JVjR7fUS6nsTm4Zc",methods:{QUERY_PAGE:"Ewi6YId8aELgLHFBBSBMT4BvG3R",queryUnionParent:"5l6jR2KUJ4QdYxLFz0ZJGFy5XZkLajNNSEdLf0t",queryShopUnion:"zPrIoMCwO3geMqwnGH2Afs0w-7lpdva",queryShop:"4VE-APqV_Fs13Cswfj8",queryChildrenByWholeCode:"sDE1BauR-rhu_AU-6F9VF952lJ_JIl-r1QOnscFpFYW0GFS9p3nAG1z",queryChildrenByWholeCodes:"CEGKxWt_AJmoqBtXoGEqET64657I2n7n39qadM-E_uX2b1O8X5k8Ii2vEnj"}},ORGANIZATION:{name:"CsxicaQ7wM_3kaiMdGJQAaOa2fUF8v-",methods:{QUERY_BY_FUNCTIONCODE:"UwBgld0zWv.T_KSfK6W2_uSPCGXiv-mkEbmTNx6qeGoR_hH",ORG_QUERY:"DOiN6_9fU1yNwZE_gRuTrdwwvEg",QUERY_TREE_FUNCTION:"-DB0-GqPoWXHozK4BKUV3yMPaFmC4lppJyYYIe9k-Gk5VCj84OEe2JBi24SnYuFqXHe",ORG_QUERY_WITHOUTDEL:"9Ivp3_1e5zNZU_miVqa6YXq9Zg0sb1JBadatp4EuTiR"}},GOODS:{name:"qVq5B_KUuBzTC3kyP9TiuA53IS1kiBn5fR5JVjR7fUS6nsTm4Zc",methods:{QUERY_PAGE:"ByoqRxHfrD8M7MGSNKC-qVN",QUERY_PAGE_GOODS_UNION:"KYI9tvUKvrmrnw02TOmUAbkj27FmFOkq8nDox-O"}},EDA:{name:"806ndPAX4QHSaL8S3kOGYVWD7gJKERC",methods:{QUERY_QUEUE_QUERYQUEUES:"NJaG8pAbK6IGAM2RtOG2V_cGwPKCj8.QKtj"}}}},9:function(e,t,a){e.exports=a(7)(105)},11:function(e,t,a){e.exports=a(7)(68)},13:function(e,t,a){"use strict";function o(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e}Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){return e&&e.__esModule?e:{default:e}}(a(9)),d=function(){var e=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZWN]|'[^']*'|'[^']*'/g,t=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,a=/[^-+\dA-Z]/g;return function(r,n,i,l){if(1!==arguments.length||"string"!==function(e){return null===e?"null":void 0===e?"undefined":"object"!==(void 0===e?"undefined":(0,s.default)(e))?void 0===e?"undefined":(0,s.default)(e):Array.isArray(e)?"array":{}.toString.call(e).slice(8,-1).toLowerCase()}(r)||/\d/.test(r)||(n=r,r=void 0),(r=r||new Date)instanceof Date||(r=new Date(r)),isNaN(r))throw TypeError("Invalid date");var u=(n=String(d.masks[n]||n||d.masks.default)).slice(0,4);"UTC:"!==u&&"GMT:"!==u||(n=n.slice(4),i=!0,"GMT:"===u&&(l=!0));var c=i?"getUTC":"get",p=r[c+"Date"](),f=r[c+"Day"](),g=r[c+"Month"](),m=r[c+"FullYear"](),h=r[c+"Hours"](),y=r[c+"Minutes"](),b=r[c+"Seconds"](),v=r[c+"Milliseconds"](),T=i?0:r.getTimezoneOffset(),C=function(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);var a=new Date(t.getFullYear(),0,4);a.setDate(a.getDate()-(a.getDay()+6)%7+3);var o=t.getTimezoneOffset()-a.getTimezoneOffset();t.setHours(t.getHours()-o);var s=(t-a)/6048e5;return 1+Math.floor(s)}(r),S=function(e){var t=e.getDay();return 0===t&&(t=7),t}(r),I={d:p,dd:o(p),ddd:d.i18n.dayNames[f],dddd:d.i18n.dayNames[f+7],m:g+1,mm:o(g+1),mmm:d.i18n.monthNames[g],mmmm:d.i18n.monthNames[g+12],yy:String(m).slice(2),yyyy:m,h:h%12||12,hh:o(h%12||12),H:h,HH:o(h),M:y,MM:o(y),s:b,ss:o(b),l:o(v,3),L:o(Math.round(v/10)),t:h<12?"a":"p",tt:h<12?"am":"pm",T:h<12?"A":"P",TT:h<12?"AM":"PM",Z:l?"GMT":i?"UTC":(String(r).match(t)||[""]).pop().replace(a,""),o:(T>0?"-":"+")+o(100*Math.floor(Math.abs(T)/60)+Math.abs(T)%60,4),S:["th","st","nd","rd"][p%10>3?0:(p%100-p%10!=10)*p%10],W:C,N:S};return n.replace(e,function(e){return e in I?I[e]:e.slice(1,e.length-1)})}}();d.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},d.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},t.default=d},62:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getTextById=function(e,t,a){var o=e.filter(function(e){return e.value===t});return o[0]?o[0].hasOwnProperty(a)?o[0][a]:o[0].hasOwnProperty("text")?o[0].text:o[0].hasOwnProperty("label")?o[0].label:void 0:""},t.M={create:"提交",update:"编辑",delete:"删除",void:"作废",valid:"反作废"},t.mb=function(e,t){return{title:"消息",type:t||"success",message:e,showCancelButton:!1,confirmButtonText:"知道了",confirmButtonClass:"is-plain"}}},85:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={template:{name:"hMNCl9S9hJbGkcd4dsaHxWWo3cOZFd3",methods:{searchTemplate:"CNXZAq_UTBYDp9COKIC-kQAnFIgOKmlWRPJXgJl",createTemplate:"c3zjwjJL9eWIAcInQqzybOqqDP4tWPwn2aoZph6",updateTemplate:"S8xZvRwVjfRS6iRKnapLHgkpbwZUg1xngMtiMIx",checkTemplate:"ibbqkvRhUQO2fRLXki402wOrWsTczmh7orisg4F",forbiddenTemplate:"XiZhTXnJofGHcYCVPJsz9lVx_fLFU6xYkqxTmRQHCPq",copyTemplate:"VggaUzBzkX9GYQtlt9Ka6pjTwGcXM2pOzmnE4n9"}},tempItem:{name:"hMNCl9S9hJbGkcd4dsaHxWWo3cOZFd3",methods:{updateTempItem:"LnUSpgz6fZCYfe0kwIbZ0ceGFnUFChh",checkTempItem:"7QBLR5i4fMgzMI5wWk3zlMCSNBDidhv",searchTempItemList:"vLnojOoObKzDxJBqiWbhxcdaTWNpR8t",forbiddenTempItem:"ktovV_QnU-ehl9s6hgAr1TgpHqgqebVRPJ3",copyTempItem:"M1UAC6T5be52FLLhASJBidGRaN69tnc",tempRecordQuery:"DIdYCqAfWpr3qnB2uc6qgY76sWQKGruDy6l"}},supply:{name:"8m7ufp84fb2V0f5Z0e1LiSKvI9wfWGyPcR5O8IydTmjLcK9YcKE",methods:{queryGoodsForSetSku:"1yvDQ5-lGkBG40OpMk61e9oxDjiPVvn9iKjCyrD7Ol3nucH",queryEffectGoodsByCity:"8PoySH4qiMN2F8IS6OYE5bKs0p1MUxUSVpZxjap8w2y",queryEffectGoodsByCityAndSalePrice:"HSmeFx6Fz1ztAEC-cwOBT0gAzFkU74kMkhrP8LG8zKC05LJdss0BN-dynXo"}},schedule:{name:"PHZ4wJ5NChyZm_bdgBuKFocGUCzQOjT",methods:{module:"i7i7ssrGiIWkCwyuNS8vsJrQ8YIvxaAWIZ-xlYS",getInfoQuotaion:"7lBW1onPuYVQ_lUM1lmsvuWwSEqVC2jCWxXkS5rTOAkEgxyYP69",queryModuleAndModuleItemById:"Z0FlRV4xWyTqaV6Q3EVniJfCtY-F0_V5jcTdMPM2iLT1jESsRRTQkYAZ2w4ITO4"}}}},96:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){return e&&e.__esModule?e:{default:e}}(a(13)),s={datas:{mould_status:[{text:"待启用",value:0},{text:"审核中",value:1},{text:"已启用",value:2},{text:"已驳回",value:3}],temp_item_status:[{text:"待启用",value:0},{text:"审核中",value:1},{text:"已启用",value:2},{text:"已驳回",value:3}],dosage_mapping_status:[{text:"待配置",value:0},{text:"待启用",value:1},{text:"审核中",value:2},{text:"已启用",value:3}],item_price_status:[{text:"待启用",value:0},{text:"审核中",value:1},{text:"已启用",value:2},{text:"已驳回",value:3}],gd_mapping_status:[{text:"待启用",value:0},{text:"审核中",value:1},{text:"已启用",value:2},{text:"已驳回",value:3}],settle_type:[{text:"不参与结算",value:0},{text:"工长结算",value:1}],gd_mapping_forbidden_status:[{text:"否",value:0},{text:"是",value:1}],needSelectSel:[{text:"不需要",value:0},{text:"需要",value:1}],isBomSel:[{text:"否",value:0},{text:"是",value:1}]},columns:[{prop:"tempCode",label:"产品包模板编码"},{prop:"tempName",label:"产品包模板名称",width:200},{prop:"orgId",label:"组织",width:100,list:"organizes"},{prop:"pkgId",label:"产品包",list:"productPackages"},{prop:"updateTime",label:"修改时间"},{prop:"effectTime",label:"生效时间",formatter:function(e){return e?(0,o.default)(new Date(e).getTime(),"yyyy-mm-dd HH:MM"):"--"}},{prop:"freezeTime",label:"冻结时间",formatter:function(e){return e?(0,o.default)(new Date(e).getTime(),"yyyy-mm-dd HH:MM"):"--"}},{prop:"forbiddenTime",label:"禁用时间",formatter:function(e){return e?(0,o.default)(new Date(e).getTime(),"yyyy-mm-dd HH:MM"):"--"}},{prop:"tempStatus",label:"模板状态",list:"mould_status"}]};t.default=s},99:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=o(a(1)),d=o(a(107)),r=o(a(108));t.default={getRelationStoragesByAccountId:function(e){return(0,s.default)({method:d.default.STORAGES.methods.getRelationStoragesByAccountId,service:d.default.STORAGES.name,args:{accountId:e}})},getAllBranchCompany:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.getOrganizationByTypeCode(r.default.typeCode.branchCompany,e)},getAllBranchCompanyAndStore:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.getOrganizationByTypeCode([r.default.typeCode.branchCompany,r.default.typeCode.store],e)},getAllStore:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.getOrganizationByTypeCode(r.default.typeCode.store,e)},getOrganizationByTypeCode:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a={};return a="string"==typeof e?{typeCode_eq:e}:{typeCode_in:e},t&&(a.isDel=0),this.searchOrganization(a)},getAllStoreByCompanyId:function(e){var t={};return e&&(t={parentId_eq:e,typeCode_eq:r.default.typeCode.store}),this.searchOrganization(t)},searchOrganization:function(e){return(0,s.default)({method:d.default.STORAGES.methods.organizationQuery,service:d.default.STORAGES.name,args:{search:e}})},findOrgById:function(e){return(0,s.default)({method:d.default.STORAGES.methods.findOrgById,service:d.default.STORAGES.name,args:{id:e}})}}},105:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={name:"wmAKWV2XF-EkCFneNrEJ3dM5eZPAju3",formula:{methods:{findById:"QhzpTDNYE87liBS7jO8idAU23P4",query:"ldNGC1iEgcifG-2geholbMM",queryPage:"S6L2uE_QhBROzWHNLpY76a-vQJp",getResult:"p0MBqQSnRKG3pneYiIWSXFpWfmP"}},constant:{query:"8Vd-9J1kEu52Qw58lLvIPIk",queryPage:"NWwTRmCDAHyhTIAIZBHFF4JOCxa"},variable:{findById:"NlG_mOeFhjFJvYzmkzLGQpRXEd0",query:"Cs4XJsYeW_1xJnzwoa2dn6P",queryPage:"djG1fWDPXJ.ZbhUCETdYkQVXgKq"}}},107:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={STORAGES:{name:"L29ayPpC3PMWdg8tnQJNjYmuSEjMDZB",methods:{getRelationStoragesByAccountId:"6qpYf6GYaQS4mIzrd5co3UM36bDW6ZEJrX7U0iPIc1hxXfiz3DN",organizationQuery:"a-GBd1krF7w0DBvjMsd4F0orXdF",findOrgById:"n1EjEy1fY2s_QBnicLnD5DoAup7FqQi3fyx"}},INVORGS:{name:"XAgCY5Yu3vtfJ5mOz6l1EatklIpkR9ATvWAjWO5sLB9onDCTTYI",methods:{orgQueryPage:"9C7rcd65dU6JnNd4kGqUpR_6QCAqFOtANDv9BpD85kG8d1j",orgQuery:"ObB7LfrK0M3VLALaE6xboHiffuTm4lgbkAxRdd0QS0F",storageQuery:"isWQivU5v8S4WStoLiUSpvTu31ya5h.swBH",goodsRecordList:"7EesjOInTJa7X_HMS-V-UCZCYNloSCuZjp6GdscyzGhQt1y",storageBinQuery:"99rdBMsbQptsCPGZfPbDEAo8qQJfjOG7dIcEgJ0",statusQuery:"hcULftT8j8fAoEUOShvgp8iNO30wd6yjmHd"}}}},108:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={typeCode:{mainCompany:"001003001",company:"001003002",factory:"001003003",bu:"001003004",region:"001003005",branchCompany:"001003006",agency:"001003007",section:"001003008",storage:"001003009",store:"001003010",group:"001003011",others:"001003012",gallery:"001003014"}}},127:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=o(a(76)),d=o(a(9)),r=o(a(21)),n=o(a(1)),i=o(a(105));t.default={formulaQuery:function(e){return(0,n.default)({method:i.default.formula.methods.query,service:i.default.name,args:{search:e}})},selectFormulaByTypeId:function(e){return this.formulaQuery({typeId:e})},selectFormulaByModuleId:function(e){return this.formulaQuery({moduleId:e})},findById:function(e){return(0,n.default)({method:i.default.formula.methods.findById,service:i.default.name,args:{id:e}})},formulaGetResult:function(e,t){var a={id:e};return"{}"!=(0,r.default)(t)&&(a.args=t),(0,n.default)({method:i.default.formula.methods.getResult,service:i.default.name,args:a})},formatFormulaForView:function(e){var t=[];return e.forEach(function(e,a){t.push({text:e.formulaName,value:e.id})}),t},constantQueryPage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a={page:arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,size:arguments.length>3&&void 0!==arguments[3]?arguments[3]:1};return 0!=e&&"object"==(void 0===e?"undefined":(0,d.default)(e))&&(a.search=e),0!=t&&"object"==(void 0===t?"undefined":(0,d.default)(t))&&(a.sort=t),(0,n.default)({method:i.default.constant.queryPage,service:i.default.name,args:a})},getUseInConstant:function(e,t,a,o){var d=this;return new s.default(function(s,r){d.constantQueryPage({typeName:e,status:1,useRange:t,validTimeTypeCode:a,endTime:o},["validTime_desc"],1,1).then(function(e){200==e.data.status?s(e.data.result.rows):r()}).catch(function(e){r()})})}}},129:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=o(a(1)),d=o(a(164));t.default={create:function(e){return(0,s.default)({method:d.default.TEMPLATE.methods.CREATE,service:d.default.TEMPLATE.name,args:e})},update:function(e){return(0,s.default)({method:d.default.TEMPLATE.methods.UPDATE,service:d.default.TEMPLATE.name,args:e})},setModuleStatus:function(e){return(0,s.default)({method:d.default.TEMPLATE.methods.SETMODULESTATUS,service:d.default.TEMPLATE.name,args:e})},queryModuleQuotaionById:function(e){return(0,s.default)({method:d.default.TEMPLATE.methods.queryModuleQuotaionById,service:d.default.TEMPLATE.name,args:e})},moduleItemQueryPage:function(e){return(0,s.default)({method:d.default.TEMPLATE.methods.QUERY,service:d.default.TEMPLATE.name,args:e})},queryCategory:function(e){return(0,s.default)({method:d.default.PROPERTY.methods.queryCategory,service:d.default.PROPERTY.name,args:e})},queryGroupsAndChilds:function(e){return(0,s.default)({method:d.default.PROPERTY.methods.queryGroupsAndChilds,service:d.default.PROPERTY.name,args:e})},queryList:function(e){return(0,s.default)({method:d.default.PROPERTY.methods.queryList,service:d.default.PROPERTY.name,args:e})}}},147:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={TEMPLATE:{name:"hMNCl9S9hJbGkcd4dsaHxWWo3cOZFd3",methods:{QUERY:"0sm1rzIREcJRG0MZDYxnV8RoTGpbjnWqWIyKpBpGQ3ecrDjqLkxXl-YoKY3tnGB",CREATE:"mFD_4_xm2G5fVC3Ctf9icuqFnLgwVEsuSLoewNkNCC6Awp3O0bwwksvyLfL",UPDATE:"35-6x8iF0jID7w8omkoU_eAiEdsk_VcLEiZ340qFTI1blmzdvEedlptSGRG",queryModuleQuotaionById:"bsx0wpzI8XAEKxuFTSdpB0W2Y8USbAiRjBCrEjtryI8shhuaiGfqCf3",queryUserSpace:"zL7FIJrQ3YGaZJ7KpRIA47B9I8xBHDP",querySpaceConfig:"BICJrUoNsiTmx8D707546J-EIPO"}},PROPERTY:{name:"8m7ufp84fb2V0f5Z0e1LiSKvI9wfWGyPcR5O8IydTmjLcK9YcKE",methods:{propertyQueryPage:"xxyFxYonI0x3Fv7Po3D98lC_z76",queryCategory:"fue2Bug7gAf8EzJAhQi-8IwMllaKWZlwhefb6kXUbX3"}}}},148:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=o(a(1)),d=o(a(147));t.default={create:function(e){return(0,s.default)({method:d.default.TEMPLATE.methods.CREATE,service:d.default.TEMPLATE.name,args:e})},update:function(e){return(0,s.default)({method:d.default.TEMPLATE.methods.UPDATE,service:d.default.TEMPLATE.name,args:e})},setModuleStatus:function(e){return(0,s.default)({method:d.default.TEMPLATE.methods.SETMODULESTATUS,service:d.default.TEMPLATE.name,args:e})},queryModuleQuotaionById:function(e){return(0,s.default)({method:d.default.TEMPLATE.methods.queryModuleQuotaionById,service:d.default.TEMPLATE.name,args:e})},moduleItemQueryPage:function(e){return(0,s.default)({method:d.default.TEMPLATE.methods.QUERY,service:d.default.TEMPLATE.name,args:e})},queryCategory:function(e){return(0,s.default)({method:d.default.PROPERTY.methods.queryCategory,service:d.default.PROPERTY.name,args:e})},queryUserSpace:function(e){return(0,s.default)({method:d.default.TEMPLATE.methods.queryUserSpace,service:d.default.TEMPLATE.name,args:e})},querySpaceConfig:function(e){return(0,s.default)({method:d.default.TEMPLATE.methods.querySpaceConfig,service:d.default.TEMPLATE.name,args:e})},getSpaceConfigList:function(){var e=[];return this.querySpaceConfig({fields:["id","name"]}).then(function(t){200===t.data.status&&t.data.result.forEach(function(t){e.push({value:t.id,text:t.name})})}),e}}},164:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={TEMPLATE:{name:"hMNCl9S9hJbGkcd4dsaHxWWo3cOZFd3",methods:{QUERY:"q233b2f_ZDW0ZYsEv747sInfb5epY4F1PbmetMoaS3ri-_g",CREATE:"G4H63EhuPrdvX-pGTytKOIXuYnIGIu7yQwXs_pKA0pS",UPDATE:"PWPB7WMqa2hfjnFF3YG5EOgMgx_7E5G2BEcIguR26yw",queryModuleQuotaionById:"XbgLT0IoDgrYaXRF9kakeoRxw7XZiHT1NrzU_-3"}},PROPERTY:{name:"8m7ufp84fb2V0f5Z0e1LiSKvI9wfWGyPcR5O8IydTmjLcK9YcKE",methods:{propertyQueryPage:"xxyFxYonI0x3Fv7Po3D98lC_z76",queryCategory:"fue2Bug7gAf8EzJAhQi-8IwMllaKWZlwhefb6kXUbX3",queryGroupsAndChilds:"MaZUrIPS5tH4QpWkLT635op0rqP_JhRGIZC_V_H9lBW",queryList:"hQ5MO8vDt9bGHRuH3xra-osa-2zSRzS"}}}},165:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={default:{name:"hMNCl9S9hJbGkcd4dsaHxWWo3cOZFd3",methods:{searchGroupDosageMapping:"m6t9xAkI1PN3wdHdhRTimqt-thhvbMyaB6Rte7zsqSN",createGroupDosageMapping:"aePeXj6mCkJvHTE_-Z4JoeRgOHEF5ZHW5R4kNHwaSCsDJ6s",createGroupDosageMappingBatch:"XciQXLh3WSdy1oVB_uTFizbPzAHCCppA_yf1k3qE8_qW_DLIuGO",updateGroupDosageMapping:"k1fhZBV6lEYoklMhRiGaoowRJigN8nlyuZnyPi3oTMDTM8K",updateGroupDosageMappingBatch:"ss0lvaDWAkHGCdVQEq3BMwn2fKkhT7qTMnJ2V_ZFUCZeGttnYY4",checkGroupDosageMapping:"nCY55jOR1yOe03hKews9nr1KpTgvcIJxr-BVvn9fwXH",effectGroupDosageMapping:"2xBT-9PsK2Eo88yMNmEsk6kSutw3dNn1GGmxxexmFuu5ZgY",forbiddenGroupDosageMapping:"TGdcfSizoAzEZHRs5SyyD.KQtPCD-7XWRjRFROmXcygQAGQCan8",getGdmTitle:"HjknI1H0qH9yEwZT9AJ5ILW1X4WS9eVR6jHjBjbSz2Q48rQCTvWHQ8Y",getSkuTitle:"frdwgv_yoftrMxmb4OPBSjeugQQKF2OZ7wPePpjcL-MBwt9IKroeIdE"}}}},169:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={quoteItem:{name:"hMNCl9S9hJbGkcd4dsaHxWWo3cOZFd3",methods:{quoteItemQueryPage:"QLKWUxAVC54gB7Jh3V1T93YA3qoXK8YA4yFOrH5"}}}},194:function(e,t,a){a(327),a(326);var o=a(4)(a(240),a(387),"data-v-299167b2",null);e.exports=o.exports},199:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={TEMPLATE:{name:"rk2RJ6Qwg5g0AL966MJ2RE5jlMKzsKr",methods:{expenseDictionaryQueryPage:"r001f4hDonWwAppN1X2Xh3mGhrcLOwb20-vr.Xjf3zenmfm",expenseDictionaryFilterWokerTypes:"CjOdE0Fo-mNdkWMwv_N2OVgJQYvzGSjYrPdhSWrn63v-ukoSRuKaL-bTsm5",expenseMatchQuotaQueryPage:"w4D-d5x-SygpmJtoL2hYeItQl1Ss5ovLm8mpCYtfA4ixqxs",expenseQuotaQueryPage:"qzw06RGZ5lhAOl4I_6FT0QCoCg-a0QBj2nF2VRI4bNN"}}}},205:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=o(a(1)),d=o(a(165));t.default={getSkuTitle:function(e){return(0,s.default)({method:d.default.default.methods.getSkuTitle,service:d.default.default.name,args:{gdmId:e}})},getGdmTitle:function(e){return(0,s.default)({method:d.default.default.methods.getGdmTitle,service:d.default.default.name,args:{itemCode:e}})},createGdm:function(e){return(0,s.default)({method:d.default.default.methods.createGroupDosageMapping,service:d.default.default.name,args:{groupDosageMapping:e}})},createGdmBatch:function(e){return(0,s.default)({method:d.default.default.methods.createGroupDosageMappingBatch,service:d.default.default.name,args:{groupDosageMapping:e}})},updateGdm:function(e){return(0,s.default)({method:d.default.default.methods.updateGroupDosageMapping,service:d.default.default.name,args:{groupDosageMapping:e}})},updateGdmBatch:function(e){return(0,s.default)({method:d.default.default.methods.updateGroupDosageMappingBatch,service:d.default.default.name,args:{groupDosageMapping:e}})},checkGdm:function(e){return(0,s.default)({method:d.default.default.methods.checkGroupDosageMapping,service:d.default.default.name,args:{groupDosageMapping:e}})},effectGdm:function(e){return(0,s.default)({method:d.default.default.methods.effectGroupDosageMapping,service:d.default.default.name,args:{groupDosageMapping:e}})},forbiddenGdm:function(e){return(0,s.default)({method:d.default.default.methods.forbiddenGroupDosageMapping,service:d.default.default.name,args:{groupDosageMapping:e}})}}},206:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});o(a(1)),o(a(169));t.default={}},240:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=o(a(11)),d=o(a(13)),r=(a(62),o(a(6))),n=o(a(5)),i=o(a(205)),l=o(a(165)),u=(o(a(194)),o(a(96))),c=o(a(129)),p=o(a(148)),f=o(a(127)),g=o(a(105)),m=o(a(245));t.default={name:"groupDosageMapping",components:{},data:function(){return{editMode:"cell",tempItemCode:"",tempCode:"",groupDosageMappingDialogVisible:!0,expenseDictionariesUniq:[],disabledSymbolsTop:[],disabledSymbolsBody:[],mainTableService:l.default.default.name,mainTableMethod:l.default.default.methods.searchGroupDosageMapping,mainTableColumns:[{prop:"id",label:"组合ID"},{prop:"gdType",label:"组合类型",list:"types",required:!0,editor:{type:"select",rules:[{required:!0,message:"请选择组合类型"}]}},{prop:"gdmName",label:"组合名称",required:!0,list:"goodCategories",editor:{type:"select",rules:[{required:!0,message:"请填写组合名称"},{max:50,message:"长度不能超多50个字符"}]}},{prop:"categoryId",label:"品类",required:!0,editor:{type:"select",rules:[{required:!0,message:"请选择品类"}],list:"goodsCategoryEditor"},formatter:this.formatterCateGoryId},{prop:"costUnitPrice",label:"成本单价",editor:{type:"input",rules:[{pattern:/^((0|[1-9]\d{0,6})((\.[0-9]{1,2})?))$/,message:"必须为数字，最大7位，最多保留两位小数"}]}},{prop:"dosagePercent",label:"用量比例",required:!0,editor:{type:"input",rules:[{pattern:/^(0|[1-9]{1}[0-9]{0,3}|([1-9]{1}[0-9]{0,3}|0)\.[0-9]{1,2})$/,message:"0-9999，最多保留两位小数"},{required:!0,message:"请填写用量比例"}]}},{prop:"dosageEquationId",label:"用量公式名称",list:"dosageEquations",required:!0,editor:{type:"lookup",service:g.default.name,method:g.default.formula.methods.queryPage,args:{},searchValue:"",filterMethod:function(e,t){var a=(0,s.default)({},t),o={moduleId:t.search.moduleId};return e&&(o.formulaName=e),a.search=o,a},columns:[{prop:"id",label:"公式ID"},{prop:"formulaName",label:"公式名"},{prop:"expression",label:"表达式"}],valueExpr:"id",searchExpr:["formulaName"],rules:[{required:!0,message:"请选择用量公式"}],list:"dosageEquationsEditor"}},{prop:"floatPercent",label:"浮动比例",required:!0,editor:{type:"input",rules:[{pattern:/^(0|((0\.[0-9]{1,4})?))$/,message:"必须为数字，不能大于等于1，最多保留四位小数"},{required:!0,message:"请填写浮动比例"}]}},{prop:"effectTime",label:"生效时间",required:!0,editor:{type:"datetime",rules:[{required:!0,message:"生效时间必填"}],pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()}}},formatter:function(e){return e?(0,d.default)(new Date(e).getTime(),"yyyy-mm-dd HH:MM"):"--"}},{prop:"forbiddenStatus",label:"是否禁用",list:"gd_mapping_forbidden_status"},{prop:"gdMappingStatus",label:"状态",list:"gd_mapping_status"}],args:{},commonData:{types:[],goodsCategory:[],gd_mapping_status:u.default.datas.gd_mapping_status,gd_mapping_forbidden_status:u.default.datas.gd_mapping_forbidden_status,dosageEquations:[{text:"默认",value:1}]},templateData:{categoryId:null,skuId:null,categoryName:null,gdmName:null},formData:{places:[]},formFields:[{type:"input",prop:"itemCode",label:"产品包模板行编码",disabled:!0},{type:"input",prop:"qiName",label:"报价项名称",disabled:!0},{type:"select",prop:"spaceName",label:"空间",disabled:!0},{type:"select",prop:"placeId",label:"位置",list:"places",placeholder:"选择位置",disabled:!0},{type:"input",prop:"qiUnit",label:"单位",disabled:!0},{type:"select",prop:"tempItemStatus",label:"行状态",disabled:!0,list:"tempItemStatus"},{type:"input",prop:"tempName",label:"产品包模板名称",disabled:!0}],formCommonData:{tempItemStatus:u.default.datas.temp_item_status,places:[]},selectSource:{types:[],goodsCategory:[]},goodsCategory:[],goodsCategoryEditor:[],allGoodsCategory:[],goodsCategoryMapping:{},gdTypeAndCateMapping:{},formatFormula1:[],formatFormula2:[],formulaModuleId:null,formulaModuleId2:null,headData:{},actionModel:"",accountId:+r.default.get("t8t-tc-uid"),hotRow:[]}},created:function(){var e=this;this.init(),this.getCommonOptions("31003","types"),this.getCategoryGoods(),this.getGoodsCateGoryMapping(),this.getCommonOptions("31004","goodCategories","propertyName","propertyName"),n.default.queryUnionParent({page:1,search:{pPropertyCode:11602,propertyCode:3001},size:100}).then(function(t){200===t.data.status&&t.data.result.length>0&&(e.formulaModuleId=t.data.result[0].id,f.default.selectFormulaByModuleId(t.data.result[0].id).then(function(t){if(200==t.data.status){var a=e.formatFormula1=f.default.formatFormulaForView(t.data.result);e.commonData.dosageEquations=[].concat([],a),n.default.queryUnionParent({page:1,search:{pPropertyCode:11602,propertyCode:4e3},size:100}).then(function(t){200===t.data.status&&t.data.result.length>0&&(e.formulaModuleId2=t.data.result[0].id,f.default.selectFormulaByModuleId(t.data.result[0].id).then(function(t){if(200==t.data.status){var a=e.formatFormula2=f.default.formatFormulaForView(t.data.result);e.commonData.dosageEquations=[].concat(e.commonData.dosageEquations,a)}}))})}}))}),this.getExpenseDictionariesUniq()},methods:{isEmpty:function(e){return null==e||0==e||""==e||void 0==e||"0"==e},floorDateFromStr:function(e){return this.isEmpty(e)?e:Math.floor(new Date(e).getTime()/1e3)},init:function(){var e=this;this.tempItemCode=this.$route.query.tempItemCode,this.tempCode=this.$route.query.tempCode,this.args={groupDosageMapping:{itemCode:this.tempItemCode,gdMappingId:0}};i.default.getGdmTitle(this.tempItemCode).then(function(t){200==t.data.status&&(e.headData=e.formData=(0,s.default)({},t.data.result))}),this.formCommonData.spaces=p.default.getSpaceConfigList(),this.getCommonOptions(30003,"places")},getCateGoryNameById:function(e){this.getCategoryGoods();var t="";return this.selectSource.goodsCategory.forEach(function(a){a.value==e&&(t=a.text)}),t},cancel:function(){this.$router.go(-1)},isRowCanEdit:function(e){return[0,2,3].indexOf(e.gdMappingStatus)>-1},isRowCanSubmit:function(e){return[0].indexOf(e.gdMappingStatus)>-1},isRowCanEffect:function(e){return[1].indexOf(e.forbiddenStatus)>-1},isRowCanForbidden:function(e){return[0].indexOf(e.forbiddenStatus)>-1&&[2].indexOf(e.gdMappingStatus)>-1},isCanEditEffectTime:function(e){return""==e.effectTime||new Date(e.effectTime).getTime()>(new Date).getTime()||0==e.gdMappingStatus&&new Date(e.effectTime).getTime()<=(new Date).getTime()},cleanHotRow:function(){this.hotRow=[]},isNewRow:function(e){return this.$refs.t8ttable.addedRows.indexOf(e)>-1},isRowEdited:function(e){return this.$refs.t8ttable.editedRows.indexOf(e)>-1},cellClick:function(e,t,a,o){if("categoryId"==t.property){var s=e.gdType;if(s){var d=this.gdTypeAndCateMapping[s],r=[];r="03"==d?this.expenseDictionariesUniq:this.goodsCategoryMapping[d],this.commonData.goodsCategoryEditor=r}else this.$refs.t8ttable.handleFormItemBlur()}if("dosageEquationId"==t.property){var n=e.gdType;if(n){var i=[],l=null;"02"==this.gdTypeAndCateMapping[n]?(i=this.formatFormula1,l=this.formulaModuleId):(i=this.formatFormula2,l=this.formulaModuleId2);var u=this.mainTableColumns.filter(function(e){return"dosageEquationId"==e.prop});u.length&&l&&(u[0].editor.args={search:{moduleId:l}}),this.commonData.dosageEquationsEditor=i}else this.$refs.t8ttable.handleFormItemBlur()}this.isNewRow(e)||(this.hotRow.indexOf(e)>-1&&"edit"==this.actionModel||this.$refs.t8ttable.handleFormItemBlur(),"effectTime"!=t.property||this.isCanEditEffectTime(e)||this.$refs.t8ttable.handleFormItemBlur()),t.property},cellEditorChange:function(e,t){if("gdType"==e.column.property){e.row.gdType;e.row.categoryId=null}},selectionChange:function(e,t,a){},addRow:function(){var e=this.$refs.t8ttable,t=(e.addedRows,e.editedRows);e.deletedIDs;if(t.length>0)return this.$message({type:"warning",message:"请先保存修改的行！"}),!1;this.actionModel="add",this.$refs.t8ttable.addNewRow()},editRow:function(){var e=this.$refs.t8ttable,t=e.addedRows;e.editedRows,e.deletedIDs;if(t.length>0)return this.$message({type:"warning",message:"请先保存新增的行！"}),!1;var a=e.getSelectRows();if(a.length<1)return this.$message({type:"warning",message:"请选择需要修改的组合"}),!1;for(var o=0;o<a.length;o++){var d=a[o];if(!this.isRowCanEdit(d))return this.$message({type:"warning",message:"仅可修改组合状态为“待启用”、“已启用” 或　“已驳回”的组合"}),!1}this.hotRow=(0,s.default)([],a),this.actionModel="edit"},submitRows:function(){var e=this,t=this.$refs.t8ttable,a=(t.addedRows,t.editedRows,t.deletedIDs,t.getSelectRows());if(a.length<1)return this.$message({type:"warning",message:"请选择需要提交的组合"}),!1;for(var o=[],s=0;s<a.length;s++){var d=a[s];if(this.isEmpty(d.effectTime))return this.$message({type:"warning",message:"请先填写生效时间"}),!1;if(!this.isRowCanSubmit(d))return this.$message({type:"warning",message:"仅可将状态为“待启用”的组合提交"}),!1;o.push(d.id)}o.length&&(this.disabledSymbolsBody.push("ROW-SUBMIT"),i.default.checkGdm({ids:o,gdMappingStatus:2,updateUser:this.accountId}).then(function(a){200==a.data.status?(e.$message({type:"success",message:"提交成功"}),e.disabledSymbolsBody.shift(e.disabledSymbolsBody.indexOf("ROW-SUBMIT")),t.reloadTable(),t.resetActionLog()):(e.$message({type:"error",message:a.data.result}),e.disabledSymbolsBody.shift(e.disabledSymbolsBody.indexOf("ROW-SUBMIT")))}))},effectRows:function(){var e=this,t=this.$refs.t8ttable,a=(t.addedRows,t.editedRows,t.deletedIDs,t.getSelectRows());if(a.length<1)return this.$message({type:"warning",message:"请选择需要启用的组合"}),!1;for(var o=[],s=0;s<a.length;s++){var d=a[s];if(!this.isRowCanEffect(d))return this.$message({type:"error",message:"仅可启用已禁用的组合"}),!1;o.push(d.id)}o.length&&(this.disabledSymbolsBody.push("ROW-ENABLE"),i.default.effectGdm({ids:o,forbiddenStatus:0,updateUser:this.accountId}).then(function(a){200==a.data.status?(e.$message({type:"success",message:"提交成功"}),e.disabledSymbolsBody.shift(e.disabledSymbolsBody.indexOf("ROW-ENABLE")),t.reloadTable()):(e.$message({type:"error",message:a.data.result}),e.disabledSymbolsBody.shift(e.disabledSymbolsBody.indexOf("ROW-ENABLE")))}))},forbiddenRows:function(){var e=this,t=this.$refs.t8ttable,a=(t.addedRows,t.editedRows,t.deletedIDs,t.getSelectRows());if(a.length<1)return this.$message({type:"warning",message:"选择需要禁用的组合"}),!1;for(var o=[],s=0;s<a.length;s++){var d=a[s];if(!this.isRowCanForbidden(d))return this.$message({type:"error",message:"仅可禁用组合状态为“已启用” 且 禁用状态为‘否’的组合"}),!1;o.push(d.id)}o.length&&(this.disabledSymbolsBody.push("ROW-DISABLE"),i.default.forbiddenGdm({ids:o,forbiddenStatus:1,updateUser:this.accountId}).then(function(a){200==a.data.status?(e.$message({type:"success",message:"提交成功"}),e.disabledSymbolsBody.shift(e.disabledSymbolsBody.indexOf("ROW-DISABLE")),t.reloadTable()):(e.$message({type:"error",message:a.data.result}),e.disabledSymbolsBody.shift(e.disabledSymbolsBody.indexOf("ROW-DISABLE")))}))},tempSave:function(){var e=this,t=this.$refs.t8ttable,a=t.addedRows,o=t.editedRows;t.deletedIDs;t.validate(function(s){if(!s)return!1;if("add"==e.actionModel)if(a.length>0){var d=[];a.forEach(function(t){d.push({itemCode:e.tempItemCode,gdType:t.gdType,gdmName:t.gdmName,categoryId:t.categoryId,categoryName:e.getCategoryNameByIdAndGdTypefunction(t.gdType,t.categoryId),dosageTypeCode:"01",dosageEquationId:t.dosageEquationId,dosagePercent:t.dosagePercent,floatPercent:t.floatPercent,costUnitPrice:t.costUnitPrice,effectTime:e.floorDateFromStr(t.effectTime),createUser:e.accountId})}),e.disabledSymbolsTop.push("TEMP-SAVE"),i.default.createGdmBatch(d).then(function(a){200==a.data.status?(e.$message({type:"success",message:"暂存成功"}),e.disabledSymbolsTop.shift(e.disabledSymbolsTop.indexOf("TEMP-SAVE")),t.reloadTable(),t.resetActionLog()):(e.$message({type:"warning",message:a.data.result}),e.disabledSymbolsTop.shift(e.disabledSymbolsTop.indexOf("TEMP-SAVE")))})}else e.$message({type:"warning",message:"没有新增的组合"});else if("edit"==e.actionModel)if(o.length>0){var r=[];o.forEach(function(t){r.push({id:t.id,gdType:t.gdType,gdmName:t.gdmName,categoryId:t.categoryId,categoryName:e.getCategoryNameByIdAndGdTypefunction(t.gdType,t.categoryId),dosageTypeCode:"01",dosageEquationId:t.dosageEquationId,dosagePercent:t.dosagePercent,floatPercent:t.floatPercent,costUnitPrice:t.costUnitPrice,effectTime:e.floorDateFromStr(t.effectTime),updateUser:e.accountId})}),e.disabledSymbolsTop.push("TEMP-SAVE"),i.default.updateGdmBatch(r).then(function(a){200==a.data.status?(e.disabledSymbolsTop.shift(e.disabledSymbolsTop.indexOf("TEMP-SAVE")),t.reloadTable(),t.resetActionLog()):(e.$message({type:"warning",message:a.data.result}),e.disabledSymbolsTop.shift(e.disabledSymbolsTop.indexOf("TEMP-SAVE")))})}else e.$message({type:"warning",message:"没有新增的组合"});else e.$message({type:"warning",message:"数据没有变化"})})},configSku:function(){var e=this.$refs.t8ttable.getSelectRows();if(e.length<1)return this.$message({type:"error",message:"请选择一行需要配置SKU的组合！"}),!1;var t=e[0];if(this.isNewRow(t))return this.$message({type:"error",message:"新增行保存后才能配置SKU！"}),!1;if(1==t.forbiddenStatus)return this.$message({type:"error",message:"已禁用的组合不可配置SKU"});var a=this.gdTypeAndCateMapping[t.gdType];this.$router.push({path:"quote-packtemp-gdmsku",query:{gdMappingId:t.id,tempCode:this.tempItemCode,propertyCode:a}})},getCommonOptions:function(e,t){var a=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"propertyName",d={page:1,search:{pPropertyCode:e},size:100},r=[];n.default.queryUnionParent(d).then(function(e){200===e.data.status&&(e.data.result.forEach(function(e){1===e.propertyStatus&&r.push({value:e[o],text:e[s],code:e.propertyCode})}),a.selectSource[t]=r,a.commonData[t]=r,a.formCommonData[t]=r)})},getGoodsCateGoryMapping:function(){var e=this;n.default.queryUnionParent({page:1,search:{pPropertyCode:31003},size:100}).then(function(t){if(200===t.data.status){t.data.result.forEach(function(t){if(1===t.propertyStatus){var a={depth:1,fields:["id","groupName","parentId","groupCode"]};c.default.queryGroupsAndChilds(a).then(function(a){if(200===a.data.status){var o=[];a.data.result.forEach(function(e){o.push({value:1*e.id,text:e.groupName,code:e.groupCode})}),e.goodsCategoryMapping[t.propertyCode]=o,e.allGoodsCategory=[].concat(e.allGoodsCategory,o),e.selectSource.goodsCategory=e.allGoodsCategory,e.commonData.goodsCategory=e.allGoodsCategory}})}e.gdTypeAndCateMapping[t.id]=t.propertyCode})}})},getGoodsCateGoryMapping_back:function(){var e=this;n.default.queryUnionParent({page:1,search:{pPropertyCode:31003},size:100}).then(function(t){if(200===t.data.status){t.data.result.forEach(function(t){if(1===t.propertyStatus){var a={queryGroupTreeOfOneDto:{fields:["id","groupName","parentId","groupCode"],groupCode:t.propertyCode}};c.default.queryCategory(a).then(function(a){if(200===a.data.status){var o=[];a.data.result.children&&a.data.result.children.forEach(function(e){o.push({value:1*e.id,text:e.groupName,code:e.groupCode})}),e.goodsCategoryMapping[t.propertyCode]=o,e.allGoodsCategory=[].concat(e.allGoodsCategory,o),e.selectSource.goodsCategory=e.allGoodsCategory,e.commonData.goodsCategory=e.allGoodsCategory}})}e.gdTypeAndCateMapping[t.id]=t.propertyCode})}})},getCategoryGoods:function(){var e=this,t={queryGroupTreeOfOneDto:{fields:["id","groupName","parentId","groupCode"],groupCode:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"02"}},a=[];c.default.queryCategory(t).then(function(t){200===t.data.status&&(t.data.result.children.forEach(function(e){a.push({value:e.id,text:e.groupName,code:e.groupCode})}),e.goodsCategory=a)})},getExpenseDictionariesUniq:function(){var e=this,t=[];m.default.getExpenseDictionariesUniq().then(function(a){200===a.data.status&&(a.data.result.forEach(function(e){t.push({value:e.workType,text:e.workTypeName})}),e.selectSource.expenseDictionariesUniq=e.commonData.expenseDictionariesUniq=e.expenseDictionariesUniq=t)})},formatterCateGoryId:function(e,t,a,o){if(t.hasOwnProperty("gdType")&&t.hasOwnProperty("categoryId")){var s=t.gdType,d=this.getCategoryByIdAndGdType(s,e);if(d.length>0)return d[0].text}return""},getCategoryByIdAndGdType:function(e,t){var a=this.gdTypeAndCateMapping[e],o=[{value:"",text:""}];return["01","02"].indexOf(a)>-1?o=this.allGoodsCategory.filter(function(e){return e.value==t}):["03"].indexOf(a)>-1&&(o=this.expenseDictionariesUniq.filter(function(e){return e.value==t})),o},getCategoryNameByIdAndGdTypefunction:function(e,t){var a="",o=this.getCategoryByIdAndGdType(e,t);return o.length&&(a=o[0].text),a},dataLoaded:function(e){var t=this;return e.map(function(e){e.hasOwnProperty("gdType")||t.$set(e,"gdType",0),e.hasOwnProperty("gdmName")||t.$set(e,"gdmName",""),e.hasOwnProperty("categoryId")||t.$set(e,"categoryId",0),e.hasOwnProperty("costUnitPrice")||t.$set(e,"costUnitPrice",""),e.hasOwnProperty("dosagePercent")||t.$set(e,"dosagePercent",""),e.hasOwnProperty("dosageEquationId")||t.$set(e,"dosageEquationId",0),e.hasOwnProperty("floatPercent")||t.$set(e,"floatPercent",""),e.hasOwnProperty("effectTime")||t.$set(e,"effectTime","")}),e}}}},245:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=o(a(21)),d=o(a(1)),r=o(a(199));t.default={getExpenseDictionaries:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i={page:e,size:t};return o.length&&(i.sort=o),n.length&&(i.fields=n),"{}"!=(0,s.default)(a)&&(i.search=a),(0,d.default)({method:r.default.TEMPLATE.methods.expenseDictionaryQueryPage,service:r.default.TEMPLATE.name,args:i})},getExpenseDictionariesUniq:function(){return(0,d.default)({method:r.default.TEMPLATE.methods.expenseDictionaryFilterWokerTypes,service:r.default.TEMPLATE.name,args:{}})}}},288:function(e,t,a){(e.exports=a(2)()).push([e.id,"\n.t8t-full-dialog2 .toolbar-container .el-button{\n    padding: 0 12px;\n    height: 26px;\n    font-size: 12px;\n    background-color: #1e3046;\n    color: #d1dde9;\n    border: 1px solid #09131d;\n}\n.t8t-full-dialog2 .toolbar-container .el-button:hover{\n    color: #1e3046;\n    background-color: #d2deeb;\n}\n\n",""])},289:function(e,t,a){(e.exports=a(2)()).push([e.id,"\n.g-main-container-column[data-v-299167b2]{\n    min-height: 400px;\n}\n",""])},326:function(e,t,a){var o=a(288);"string"==typeof o&&(o=[[e.id,o,""]]);a(3)(o,{});o.locals&&(e.exports=o.locals)},327:function(e,t,a){var o=a(289);"string"==typeof o&&(o=[[e.id,o,""]]);a(3)(o,{});o.locals&&(e.exports=o.locals)},387:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"groupDosageMapping"},[a("el-dialog",{staticClass:"groupDosageMappingDialog t8t-full-dialog2 dialog-new",attrs:{size:"full","show-close":!1,"close-on-press-escape":!1},on:{close:e.closeGroupDosageMappingDialog},model:{value:e.groupDosageMappingDialogVisible,callback:function(t){e.groupDosageMappingDialogVisible=t}}},[a("div",{staticClass:"t8t-full-dialog2-container"},[a("div",{staticClass:"full-dialog-toolbar-container"},[a("div",{staticClass:"toolbar-container"},[a("div",[a("el-button",{on:{click:function(t){e.cancel()}}},[e._v("返回")])],1),e._v(" "),a("t8t-toolbar",{staticClass:"t8t-dark",attrs:{symbolList:["TEMP-SAVE"],disabledSymbols:e.disabledSymbolsTop},on:{"TEMP-SAVE":function(t){e.tempSave()}}})],1)]),e._v(" "),a("div",{staticClass:"dialog2-main-container"},[a("div",{staticClass:"full-dialog-form-container"},[a("t8t-form-panel",{ref:"groupDosageMappingForm",attrs:{dataSource:e.formData,fields:e.formFields,commonData:e.formCommonData}})],1),e._v(" "),a("div",{staticClass:"g-main-container-column"},[a("t8t-toolbar",{attrs:{symbolList:["ROW-ADD","SKU-CONFIG","ROW-EDIT","ROW-SUBMIT","ROW-ENABLE","ROW-DISABLE"],disabledSymbols:e.disabledSymbolsBody},on:{"ROW-ADD":function(t){e.addRow()},"SKU-CONFIG":function(t){e.configSku()},"ROW-EDIT":function(t){e.editRow()},"ROW-SUBMIT":function(t){e.submitRows()},"ROW-ENABLE":function(t){e.effectRows()},"ROW-DISABLE":function(t){e.forbiddenRows()}}}),e._v(" "),a("t8t-table",{ref:"t8ttable",attrs:{columns:e.mainTableColumns,service:e.mainTableService,method:e.mainTableMethod,commonData:e.commonData,"edit-mode":e.editMode,args:e.args,indexCol:!1,pageBar:!0,editable:!0,templateData:e.templateData},on:{"cell-click":e.cellClick,"selection-change":e.selectionChange,"cell-editor-change":e.cellEditorChange,"data-loaded":e.dataLoaded}})],1)])])])],1)},staticRenderFns:[]}},780:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=o(a(11)),d=a(62),r=o(a(6)),n=o(a(5)),i=o(a(205)),l=o(a(165)),u=(o(a(194)),o(a(2228))),c=o(a(2226)),p=o(a(96)),f=o(a(129)),g=o(a(127)),m=o(a(105)),h=o(a(99));t.default={name:"groupDosageMapping",components:{selectSkuGoodDialog:u.default,selectExpenseQuotaDialog:c.default},data:function(){return{editMode:"cell",gdMappingId:"",tempCode:"",groupDosageMappingDialogVisible:!0,addGoodsDialogVisible:!1,addExpenseQuotaDialogVisible:!1,currentRow:{},skuId:"",bomGdmId:0,propertyCode:"",activeTableRef:"t8ttable",disabledSymbols:[],isCanSubmit:!0,isCanEffect:!0,isCanForbidden:!0,mainTableService:l.default.default.name,mainTableMethod:l.default.default.methods.searchGroupDosageMapping,mainTableColumns:[{prop:"id",label:"ID",width:100},{prop:"bomGdmId",label:"父组件ID",width:100},{prop:"needSelect",label:"需要选品",list:"needSelectSel",required:!0,width:100,editor:{type:"select",rules:[{required:!0,message:"请选择是否需要选品"}]}},{prop:"isBom",label:"是否bom",list:"isBomSel",required:!0,width:100,editor:{type:"select",rules:[{required:!0,message:"请选择是否为BOM"}]}},{prop:"goodsId",label:"商品ID",width:100},{prop:"skuId",label:"SKU ID"},{prop:"productName",label:"商品名称"},{prop:"productModelVo",label:"商品型号"},{prop:"productFormatVO",label:"商品规格"},{prop:"productBrandNameVO",label:"品牌"},{prop:"dosagePercent",label:"用量比例",required:!0,editor:{type:"input",rules:[{pattern:/^(0|[1-9]{1}[0-9]{0,3}|([1-9]{1}[0-9]{0,3}|0)\.[0-9]{1,2})$/,message:"0-9999，最多保留两位小数"},{required:!0,message:"请填写用量比例"}]}},{prop:"dosageEquationId",label:"用量公式名称",list:"dosageEquations",required:!0,editor:{type:"lookup",service:m.default.name,method:m.default.formula.methods.queryPage,args:{},searchValue:"",filterMethod:function(e,t){var a=(0,s.default)({},t),o={moduleId:t.search.moduleId};return e&&(o.formulaName=e),a.search=o,a},columns:[{prop:"id",label:"公式ID"},{prop:"formulaName",label:"公式名"},{prop:"expression",label:"表达式"}],valueExpr:"id",searchExpr:["formulaName"],rules:[{required:!0,message:"请选择用量公式"}]}},{prop:"floatPercent",label:"浮动比例",required:!0,editor:{type:"input",rules:[{pattern:/^(0|((0\.[0-9]{1,4})?))$/,message:"必须为数字，不能大于等于1，最多保留四位小数"},{required:!0,message:"请填写浮动比例"}]}},{prop:"forbiddenStatus",label:"是否禁用",list:"gd_mapping_forbidden_status",width:80},{prop:"gdMappingStatus",label:"状态",list:"gd_mapping_status",width:80}],mainTableColumns2:[{prop:"expenseQuotaItemId",label:"工费项IID"},{prop:"expenseQuotaItemName",label:"工费项名称"},{prop:"dosagePercent",label:"用量比例",required:!0,editor:{type:"input",rules:[{pattern:/^(0|[1-9]{1}[0-9]{0,3}|([1-9]{1}[0-9]{0,3}|0)\.[0-9]{1,2})$/,message:"0-9999，最多保留两位小数"},{required:!0,message:"请填写用量比例"}]}},{prop:"dosageEquationId",label:"用量公式名称",list:"dosageEquations",required:!0,editor:{type:"lookup",service:m.default.name,method:m.default.formula.methods.queryPage,args:{},searchValue:"",filterMethod:function(e,t){var a=(0,s.default)({},t),o={moduleId:t.search.moduleId};return e&&(o.formulaName=e),a.search=o,a},columns:[{prop:"id",label:"公式ID"},{prop:"formulaName",label:"公式名"},{prop:"expression",label:"表达式"}],valueExpr:"id",searchExpr:["formulaName"],rules:[{required:!0,message:"请选择用量公式"}]}},{prop:"floatPercent",label:"浮动比例",required:!0,editor:{type:"input",rules:[{pattern:/^(0|((0\.[0-9]{1,4})?))$/,message:"必须为数字，不能大于等于1，最多保留四位小数"},{required:!0,message:"请填写浮动比例"}]}},{prop:"forbiddenStatus",label:"是否禁用",list:"gd_mapping_forbidden_status",width:80},{prop:"gdMappingStatus",label:"状态",list:"gd_mapping_status",width:80}],args:{},commonData:{types:[],goodsCategory:[],gd_mapping_status:p.default.datas.gd_mapping_status,gd_mapping_forbidden_status:p.default.datas.gd_mapping_forbidden_status,needSelectSel:p.default.datas.needSelectSel,isBomSel:p.default.datas.isBomSel,dosageEquations:[]},templateData:{dosageEquationId:null,dosagePercent:null,floatPercent:null,gdmName:"",bomGdmId:0},formData:{gd_mapping_status:p.default.datas.gd_mapping_status},formFields:[{type:"input",prop:"id",label:"组合ID",disabled:!0},{type:"select",prop:"gdType",list:"types",label:"组合类型",disabled:!0},{type:"input",prop:"categoryName",label:"品类",disabled:!0},{type:"select",prop:"gdMappingStatus",label:"组合状态",list:"tempItemStatus",disabled:!0},{type:"input",prop:"qiName",label:"报价项名称",disabled:!0},{type:"input",prop:"spaceName",label:"空间",disabled:!0},{type:"select",prop:"placeId",label:"位置",list:"places",disabled:!0},{type:"input",prop:"tempName",label:"产品包模板名称",disabled:!0}],formFields2:[{type:"input",prop:"id",label:"组合ID",disabled:!0},{type:"select",prop:"gdType",list:"types",label:"组合类型",disabled:!0},{type:"input",prop:"categoryName",label:"工种",disabled:!0},{type:"select",prop:"gdMappingStatus",label:"组合状态",list:"tempItemStatus",disabled:!0},{type:"input",prop:"qiName",label:"报价项名称",disabled:!0},{type:"input",prop:"spaceName",label:"空间",disabled:!0},{type:"select",prop:"placeId",label:"位置",list:"places",disabled:!0},{type:"input",prop:"tempName",label:"产品包模板名称",disabled:!0}],selectSource:{types:[],tempItemStatus:p.default.datas.temp_item_status,goodsCategory:[],places:[]},goodsCategory:[],headData:{},branchCompanyId:null,actionModel:"",accountId:+r.default.get("t8t-tc-uid"),hotRow:[]}},created:function(){var e=this;this.init(),this.getCommonOptions("31003","types"),this.getCommonOptions(30003,"places"),this.getCategoryGoods(),n.default.queryUnionParent({page:1,search:{pPropertyCode:11602,propertyCode:"02"==this.propertyCode?3001:4e3},size:100}).then(function(t){if(200===t.data.status&&t.data.result.length>0){var a=t.data.result[0].id,o=[];(o="02"==e.propertyCode?e.mainTableColumns.filter(function(e){return"dosageEquationId"==e.prop}):e.mainTableColumns2.filter(function(e){return"dosageEquationId"==e.prop})).length&&(o[0].editor.args={search:{moduleId:a}}),g.default.selectFormulaByModuleId(a).then(function(t){200==t.data.status&&(e.commonData.dosageEquations=g.default.formatFormulaForView(t.data.result))})}})},methods:{init:function(){var e=this;this.gdMappingId=this.$route.query.gdMappingId,this.tempCode=this.$route.query.tempCode,this.propertyCode=this.$route.query.propertyCode,this.args={groupDosageMapping:{gdMappingId:this.gdMappingId}};i.default.getSkuTitle(this.gdMappingId).then(function(t){200==t.data.status&&(e.headData=e.formData=(0,s.default)({},t.data.result),e.templateData.dosageEquationId=e.headData.dosageEquationId,e.templateData.dosagePercent=e.headData.dosagePercent,e.templateData.floatPercent=e.headData.floatPercent,h.default.findOrgById(e.headData.orgId).then(function(t){if(200==t.data.status){"001003010"==t.data.result.typeCode?e.branchCompanyId=t.data.result.parentId:e.branchCompanyId=e.headData.orgId}}))})},closeSelectGoodsDialog:function(){this.addGoodsDialogVisible=!1,this.addExpenseQuotaDialogVisible=!1},getCateGoryNameById:function(e){this.getCategoryGoods();var t="";return this.selectSource.goodsCategory.forEach(function(a){a.value==e&&(t=a.text)}),t},cancel:function(){this.$router.go(-1)},isRowCanEdit:function(e){return[0,3].indexOf(e.gdMappingStatus)>-1},isRowCanSubmit:function(e){return[0].indexOf(e.gdMappingStatus)>-1},isRowCanEffect:function(e){return[1].indexOf(e.forbiddenStatus)>-1},isRowCanForbidden:function(e){return[2].indexOf(e.gdMappingStatus)>-1&&[0].indexOf(e.forbiddenStatus)>-1},isCanEditEffectTime:function(e){return 0==e.gdMappingStatus&&(""==e.effectTimeVO||new Date(e.effectTimeVO).getTime()<(new Date).getTime())},cleanHotRow:function(){this.hotRow=[]},isNewRow:function(e){return this.$refs.t8ttable.addedRows.indexOf(e)>-1},isRowEdited:function(e){return this.$refs.t8ttable.editedRows.indexOf(e)>-1},cellClick:function(e,t,a,o){this.isEmpty(e.bomGdmId)||"isBom"!==t.property&&"needSelect"!==t.property||this.$refs.t8ttable.handleFormItemBlur(),this.isNewRow(e)||(this.hotRow.indexOf(e)>-1&&"edit"==this.actionModel?"skuId"===t.property&&("03"==this.propertyCode?this.addExpenseQuotaDialogVisible=!0:this.addGoodsDialogVisible=!0,this.skuId=e.skuId,this.currentRow=e):this.$refs.t8ttable.handleFormItemBlur())},selectSku:function(e){var t=this;this.itemId=e.row.id,this.getRerundOrderInfoById(e.row.refundOrderId).then(function(e){200===e.data.status?(t.invOrgId=e.data.result.rows[0].invOrgId,t.dialogVisible=!0,t.currentRefundOrderData=e.data.result.rows[0]):t.$msgbox((0,d.mb)("获取退货单信息失败","error"))})},selectionChange:function(e,t,a){},addRow:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.$refs.t8ttable;t.addedRows;if(t.editedRows.length>0)return this.$message({type:"warning",message:"请先保存修改的行！"}),!1;if(e){var a=t.getSelectRows();if(a.length<1)return this.$message({type:"warning",message:"请选择需要添加组件的行"});if(a.length>1)return this.$message({type:"warning",message:"只能选择针对一行操作"});var o=a[0];if(1!=o.isBom||0!=o.bomGdmId||!o.id)return this.$message({type:"warning",message:"只能为已经保存的BOM行添加组件"});this.bomGdmId=a[0].id}else this.bomGdmId=0;this.skuId="",this.actionModel="add","03"==this.propertyCode?this.addExpenseQuotaDialogVisible=!0:this.addGoodsDialogVisible=!0},editRow:function(){var e=this.$refs.t8ttable,t=e.addedRows;e.editedRows,e.deletedIDs;if(t.length>0)return this.$message({type:"warning",message:"请先保存新增的行！"}),!1;var a=e.getSelectRows();if(a.length<1)return this.$message({type:"warning",message:"请选择需要修改的商品"}),!1;for(var o=0;o<a.length;o++){var d=a[o];if(!this.isRowCanEdit(d))return this.$message({type:"warning",message:"仅可修改状态为“待启用”和“已驳回”的商品"}),!1}this.hotRow=(0,s.default)([],a),this.actionModel="edit"},submitRows:function(){var e=this,t=this.$refs.t8ttable,a=(t.addedRows,t.editedRows,t.deletedIDs,t.getSelectRows());if(a.length<1)return this.$message({type:"warning",message:"请选择需要提交的商品"}),!1;for(var o=[],s=0;s<a.length;s++){var d=a[s];if(!this.isRowCanSubmit(d))return this.$message({type:"warning",message:"仅可将状态为“待启用”的商品提交"}),!1;o.push(d.id)}o.length&&(this.isCanSubmit=!1,i.default.checkGdm({ids:o,gdMappingStatus:2,updateUser:this.accountId}).then(function(a){200==a.data.status?(e.$message({type:"success",message:"提交成功"}),e.isCanSubmit=!0,t.reloadTable()):(e.$message({type:"error",message:a.data.result}),e.isCanSubmit=!0)}))},effectRows:function(){var e=this,t=this.$refs.t8ttable,a=(t.addedRows,t.editedRows,t.deletedIDs,t.getSelectRows());if(a.length<1)return this.$message({type:"warning",message:"请选择需要启用的SKU"}),!1;for(var o=[],s=0;s<a.length;s++){var d=a[s];if(!this.isRowCanEffect(d))return this.$message({type:"error",message:"仅可启用状态为“已禁用”的SKU"}),!1;o.push(d.id)}o.length&&(this.isCanEffect=!1,i.default.effectGdm({ids:o,forbiddenStatus:0,updateUser:this.accountId}).then(function(a){200==a.data.status?(e.$message({type:"success",message:"启用成功"}),e.isCanEffect=!0,t.reloadTable()):(e.$message({type:"error",message:a.data.result}),e.isCanEffect=!0)}))},forbiddenRows:function(){var e=this,t=this.$refs.t8ttable,a=(t.addedRows,t.editedRows,t.deletedIDs,t.getSelectRows());if(a.length<1)return this.$message({type:"warning",message:"请选择需要禁用的SKU"}),!1;for(var o=[],s=0;s<a.length;s++){var d=a[s];if(!this.isRowCanForbidden(d))return this.$message({type:"error",message:"仅可禁用SKU状态为“已启用”且禁用状态为‘否’的SKU"}),!1;o.push(d.id)}o.length&&(this.isCanForbidden=!1,i.default.forbiddenGdm({ids:o,forbiddenStatus:1,updateUser:this.accountId}).then(function(a){200==a.data.status?(e.$message({type:"success",message:"禁用成功"}),e.isCanForbidden=!0,t.reloadTable()):(e.$message({type:"error",message:a.data.result}),e.isCanForbidden=!0)}))},tempSave:function(){var e=this,t=this,a=this.$refs.t8ttable,o=a.addedRows,s=a.editedRows;a.deletedIDs;a.validate(function(d){if(!d)return!1;if("add"==t.actionModel)if(o.length>0){var r=[];o.forEach(function(a){var o="",s="";"03"==e.propertyCode?(o=a.expenseQuotaItemId,s=a.expenseQuotaItemId):(o=a.skuId,s=a.goodsId),r.push({gdMappingId:t.gdMappingId,skuId:o,goodsId:s||"",gdmName:a.gdmName||"",dosagePercent:a.dosagePercent,floatPercent:a.floatPercent,dosageEquationId:a.dosageEquationId,createUser:e.accountId,dosageTypeCode:"02",itemCode:t.tempCode,gdType:e.headData.gdType,bomGdmId:a.bomGdmId||0,needSelect:a.needSelect||0,isBom:a.isBom||0})}),t.disabledSymbols.push("TEMP-SAVE"),i.default.createGdmBatch(r).then(function(e){200==e.data.status?(t.$message({type:"success",message:"暂存成功"}),t.disabledSymbols.shift(t.disabledSymbols.indexOf("TEMP-SAVE")),a.reloadTable(),a.resetActionLog()):(t.$message({type:"warning",message:e.data.result}),t.disabledSymbols.shift(t.disabledSymbols.indexOf("TEMP-SAVE")))})}else t.$message({type:"warning",message:"没有新增的SKU"});else if("edit"==t.actionModel)if(s.length>0){var n=[];s.forEach(function(a){var o="",s="";"03"==e.propertyCode?(o=a.expenseQuotaItemId,s=a.expenseQuotaItemId):(o=a.skuId,s=a.goodsId),n.push({id:a.id,gdMappingId:t.gdMappingId,skuId:o,goodsId:s,gdmName:a.gdmName||"",dosagePercent:a.dosagePercent,floatPercent:a.floatPercent,dosageEquationId:a.dosageEquationId,updateUser:e.accountId,dosageTypeCode:"02",gdType:e.headData.gdType,bomGdmId:a.bomGdmId||0,needSelect:a.needSelect||0,isBom:a.isBom||0})}),t.disabledSymbols.push("TEMP-SAVE"),i.default.updateGdmBatch(n).then(function(e){200==e.data.status?(t.disabledSymbols.shift(t.disabledSymbols.indexOf("TEMP-SAVE")),a.reloadTable(),a.resetActionLog()):(t.$message({type:"warning",message:e.data.result}),t.disabledSymbols.shift(t.disabledSymbols.indexOf("TEMP-SAVE")))})}else t.$message({type:"warning",message:"没有修改的SKU"});else t.$message({type:"warning",message:"数据没有变化"})})},getCommonOptions:function(e,t){var a=this,o={page:1,search:{pPropertyCode:e},size:100},s=[];n.default.queryUnionParent(o).then(function(e){200===e.data.status&&(e.data.result.forEach(function(e){1===e.propertyStatus&&s.push({value:e.id,text:e.propertyName})}),a.selectSource[t]=s,a.commonData[t]=s)})},getCategoryGoods:function(e){var t=this,a=[];f.default.queryCategory({queryGroupTreeOfOneDto:{fields:["id","groupName","parentId"],groupCode:"02"}}).then(function(e){200===e.data.status&&(e.data.result.children.forEach(function(e){a.push({value:e.id,text:e.groupName})}),t.selectSource.goodsCategory=a,t.commonData.goodsCategory=a,t.goodsCategory=a)})},isEmpty:function(e){return null==e||0==e||""==e||void 0==e||"0"==e},isNull:function(e){return null==e||""==e||void 0==e}}}},783:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=o(a(11)),d=(o(a(1)),o(a(6))),r=(o(a(206)),o(a(5)),o(a(129)),o(a(169)),o(a(85)),o(a(96)),o(a(199)));t.default={name:"selectQuoteItem",components:{},props:{skuId:{type:String,default:""},orgId:{type:String,default:""},pkg:{type:String,default:""},pkgTemp:{type:String,default:""},workType:{type:String,default:""},activeTableRef:{type:String,default:""}},data:function(){return{addGoodsDialogVisible:!0,activeTableRef:"",goodsGroups:[],userId:+d.default.get("t8t-tc-uid"),mainTableColumns:[{prop:"itemCode",label:"工费项编码"},{prop:"itemName",label:"工费项名称"},{prop:"unitQuota",label:"单位定额"}],mainTableService:r.default.TEMPLATE.name,mainTableMethod:r.default.TEMPLATE.methods.expenseMatchQuotaQueryPage,args:{search:{quotaStatus:0}},commonData:{},formData:{tempName:"",orgId:null,pkgId:"",createUser:+d.default.get("t8t-tc-uid")},formCommonData:{},selectSource:{},dataSource:{},fields:[{name:"itemCode",placeholder:"工费项编码",type:"input"},{name:"itemName",placeholder:"工费项名称",type:"input"},{name:"unitQuota",placeholder:"单位定额",type:"input"}],treedata:[],defaultProps:{children:"children",label:"label"}}},created:function(){this.args.search.organizationId=this.orgId,this.args.search.pkg=this.pkg,this.args.search.pkgTemp=this.pkgTemp,this.args.search.workType=this.workType},methods:{selectRow:function(e,t){this.addRow(e),this.cancel()},closeSelectQuoteDialog:function(){this.$emit("close")},onRowClick:function(e){},selectionChange:function(e){var t=this,a=this.$refs.t8ttable;e.forEach(function(e,o){t.isCanSkuSelection(e)||a.toggleRowSelection(e,!1)})},submit:function(){var e=this,t=this.$refs.t8ttable.getSelectRows();if(t.length<1)return this.$message({type:"warning",message:"未选择商品"}),!1;t.forEach(function(t){e.addRow(t)}),this.cancel()},addRow:function(e){var t={expenseQuotaItemId:e.id,expenseQuotaItemName:e.itemName},a=this.$parent.$refs[this.activeTableRef];(0,s.default)(a.templateData,t),this.skuId?(this.$parent.currentRow=(0,s.default)(this.$parent.currentRow,t),this.$parent.$refs[this.activeTableRef].editedRows.push(this.$parent.currentRow)):a.addNewRow()},cancel:function(){this.addGoodsDialogVisible=!1,this.$parent.closeSelectGoodsDialog()},submitSearch:function(e){var t=(0,s.default)({},e),a=(0,s.default)({},this.args);a.search=t,a.search.quotaStatus=0,a.search.organizationId=this.orgId,a.search.pkg=this.pkg,a.search.pkgTemp=this.pkgTemp,a.search.workType=this.workType,this.args=a},selectable:function(e,t){return this.isCanSkuSelection(e)},isCanSkuSelection:function(e){return!0}}}},785:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=o(a(11)),d=(o(a(1)),o(a(6))),r=(o(a(206)),o(a(5)),o(a(129))),n=(o(a(169)),o(a(85)));o(a(96));t.default={name:"selectQuoteItem",components:{},props:{skuId:{type:String,default:""},orgId:{type:String,default:""},activeTableRef:{type:String,default:""},bomGdmId:{type:String,default:""}},data:function(){return{addGoodsDialogVisible:!0,activeTableRef:"",goodsGroups:[],userId:+d.default.get("t8t-tc-uid"),mainTableColumns:[{prop:"id",label:"商品ID"},{prop:"skuId",label:"SKU ID"},{prop:"goodsName",label:"商品名称"},{prop:"model",label:"商品型号"},{prop:"standard",label:"商品规格"},{prop:"brandName",label:"品牌"}],mainTableService:"",mainTableMethod:"",args:{search:null},commonData:{},formData:{tempName:"",orgId:null,pkgId:"",createUser:+d.default.get("t8t-tc-uid")},formCommonData:{},selectSource:{},dataSource:{},fields:[{name:"goodsId",placeholder:"商品ID",type:"input"},{name:"skuId",placeholder:"SKU ID",type:"input"},{name:"goodsName",placeholder:"商品名称",type:"input"},{name:"model",placeholder:"商品型号",type:"input"}],treedata:[],defaultProps:{children:"children",label:"label"}}},created:function(){this.getTreeData()},methods:{selectRow:function(e,t){if(!this.isCanSkuSelection(e))return this.$refs.t8ttable.toggleRowSelection(e,!1),this.$message.error("没有工长价或业主价"),!1;this.addRow(e),this.cancel()},closeSelectQuoteDialog:function(){this.$emit("close")},onRowClick:function(e){this.isCanSkuSelection(e)||(this.$refs.t8ttable.toggleRowSelection(e,!1),this.$message.error("没有工长价或业主价"))},selectionChange:function(e){var t=this,a=this.$refs.t8ttable;e.forEach(function(e,o){t.isCanSkuSelection(e)||a.toggleRowSelection(e,!1)})},submit:function(){var e=this,t=this.$refs.t8ttable.getSelectRows();if(t.length<1)return this.$message({type:"warning",message:"未选择商品"}),!1;t.forEach(function(t){e.addRow(t)}),this.cancel()},addRow:function(e){var t={skuId:e.skuId,goodsId:e.id,productName:e.goodsName,productModelVo:e.model,productFormatVO:e.standard,productBrandNameVO:e.brandName,shopNameVO:e.shopName,bomGdmId:this.bomGdmId};this.bomGdmId&&(t.isBom=0,t.needSelect=0);var a=this.$parent.$refs[this.activeTableRef];(0,s.default)(a.templateData,t),this.skuId?(this.$parent.currentRow=(0,s.default)(this.$parent.currentRow,t),this.$parent.$refs[this.activeTableRef].editedRows.push(this.$parent.currentRow)):a.addNewRow()},cancel:function(){this.addGoodsDialogVisible=!1,this.$parent.closeSelectGoodsDialog()},submitSearch:function(e){e.gGoodsGroups=this.goodsGroups?this.goodsGroups:[];var t=(0,s.default)({},e);t.goodsId&&(t.goodsIds=[+t.goodsId]);var a=(0,s.default)({},this.args);a.queryEffectGoodsByCityAndSalePriceDTO.searchGoods=t,this.args=a},getTreeData:function(){var e=this,t=this.$parent.formData.categoryId;this.treedata=[{label:"全部",value:"",children:[]}],r.default.queryList({search:{id_in:[t]},fields:["id","depth","description","groupCode","groupName"]}).then(function(a){if(200==a.data.status){var o={queryGroupTreeOfOneDto:{fields:["id","groupName","parentId","groupCode","groupStatus"],groupCode:a.data.result[0].groupCode}};r.default.queryCategory(o).then(function(a){var o=[];e.goodsGroups=[].concat([],t),a.data.result.children&&a.data.result.children.length>0&&(o=a.data.result.children),200===a.data.status&&a.data.result&&(e.buildTreeData(e.treedata[0].children,o),e.getAllCates(e.goodsGroups,e.treedata[0].children),e.goodsGroups.length&&(e.mainTableService=n.default.supply.name,e.mainTableMethod=n.default.supply.methods.queryEffectGoodsByCityAndSalePrice),e.args={queryEffectGoodsByCityAndSalePriceDTO:{orgId:e.orgId,searchGoods:{gGoodsGroups:e.goodsGroups}}})})}})},buildTreeData:function(e,t){var a=this;t&&t.length>0&&t.forEach(function(t){var o={label:t.groupName,value:t.id,children:[]};e.push(o),a.buildTreeData(o.children,t.children)})},getAllCates:function(e,t){var a=this;t&&t.length>0&&t.forEach(function(e){a.goodsGroups=[].concat(a.goodsGroups,e.value),a.getAllCates(a.goodsGroups,e.children)})},handleNodeClick:function(e){var t=this.$refs.search.getFormData();this.goodsGroups=[].concat([],this.$parent.formData.categoryId),e.value&&(this.goodsGroups=[e.value]),this.getAllCates(this.goodsGroups,e.children),this.submitSearch(t)},selectable:function(e,t){return this.isCanSkuSelection(e)},isCanSkuSelection:function(e){return!0}}}},1086:function(e,t,a){(e.exports=a(2)()).push([e.id,"\n.t8t-full-dialog2 .toolbar-container .el-button{\n    padding: 0 12px;\n    height: 26px;\n    font-size: 12px;\n    background-color: #1e3046;\n    color: #d1dde9;\n    border: 1px solid #09131d;\n}\n.t8t-full-dialog2 .toolbar-container .el-button:hover{\n    color: #1e3046;\n    background-color: #d2deeb;\n}\n\n\n",""])},1087:function(e,t,a){(e.exports=a(2)()).push([e.id,"\n.g-main-container-column[data-v-3b47a48a]{\n    min-height: 300px;\n}\n",""])},1177:function(e,t,a){(e.exports=a(2)()).push([e.id,"\n.g-main-container-column[data-v-561edb48]{\n}\n.selectQuoteItemdialog[data-v-561edb48]{\n}\n.my-el-dialog .el-dialog[data-v-561edb48]{width:1300px  !important;\n}\n.worker-sku-goods-contain[data-v-561edb48]{margin-left: 10px!important;\n}\n.worker-sku-goods-tree[data-v-561edb48]{max-height: 340px; overflow: auto;font-size:12px !important;\n}\n",""])},1369:function(e,t,a){(e.exports=a(2)()).push([e.id,"\n.g-main-container-column[data-v-f981da44]{\n}\n.selectQuoteItemdialog[data-v-f981da44]{\n}\n.my-el-dialog .el-dialog[data-v-f981da44]{width:1300px  !important;\n}\n.worker-sku-goods-contain[data-v-f981da44]{margin-left: 10px!important;\n}\n.worker-sku-goods-tree[data-v-f981da44]{max-height: 340px; overflow: auto;font-size:12px !important;\n}\n",""])},1532:function(e,t,a){var o=a(1086);"string"==typeof o&&(o=[[e.id,o,""]]);a(3)(o,{});o.locals&&(e.exports=o.locals)},1533:function(e,t,a){var o=a(1087);"string"==typeof o&&(o=[[e.id,o,""]]);a(3)(o,{});o.locals&&(e.exports=o.locals)},1623:function(e,t,a){var o=a(1177);"string"==typeof o&&(o=[[e.id,o,""]]);a(3)(o,{});o.locals&&(e.exports=o.locals)},1815:function(e,t,a){var o=a(1369);"string"==typeof o&&(o=[[e.id,o,""]]);a(3)(o,{});o.locals&&(e.exports=o.locals)},2223:function(e,t,a){a(1533),a(1532);var o=a(4)(a(780),a(2371),"data-v-3b47a48a",null);e.exports=o.exports},2226:function(e,t,a){a(1815);var o=a(4)(a(783),a(2592),"data-v-f981da44",null);e.exports=o.exports},2228:function(e,t,a){a(1623);var o=a(4)(a(785),a(2434),"data-v-561edb48",null);e.exports=o.exports},2371:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"groupDosageMapping"},[a("el-dialog",{staticClass:"groupDosageMappingDialog t8t-full-dialog2 dialog-new",attrs:{size:"full","show-close":!1,"close-on-press-escape":!1},on:{close:e.closeGroupDosageMappingDialog},model:{value:e.groupDosageMappingDialogVisible,callback:function(t){e.groupDosageMappingDialogVisible=t}}},[a("div",{staticClass:"t8t-full-dialog2-container"},[a("div",{staticClass:"full-dialog-toolbar-container"},[a("div",{staticClass:"toolbar-container"},[a("div",[a("el-button",{on:{click:function(t){e.cancel()}}},[e._v("返回")])],1),e._v(" "),a("t8t-toolbar",{staticClass:"t8t-dark",attrs:{symbolList:["TEMP-SAVE"],disabledSymbols:e.disabledSymbols},on:{"TEMP-SAVE":function(t){e.tempSave()}}}),e._v(" "),a("div",[a("el-button",{on:{click:function(t){e.addRow()}}},[e._v("新增")]),e._v(" "),a("el-button",{on:{click:function(t){e.editRow()}}},[e._v("修改")]),e._v(" "),a("el-button",{attrs:{disabled:!e.isCanSubmit},on:{click:function(t){e.submitRows()}}},[e._v("提交")]),e._v(" "),a("el-button",{attrs:{disabled:!e.isCanEffect},on:{click:function(t){e.effectRows()}}},[e._v("启用")]),e._v(" "),a("el-button",{attrs:{disabled:!e.isCanForbidden},on:{click:function(t){e.forbiddenRows()}}},[e._v("禁用")]),e._v(" "),a("el-button",{on:{click:function(t){e.addRow(!0)}}},[e._v("添加子组件")])],1)],1)]),e._v(" "),a("div",{staticClass:"dialog2-main-container"},[a("div",{staticClass:"full-dialog-form-container"},[a("t8t-form-panel",{ref:"groupDosageMappingForm",attrs:{dataSource:e.formData,fields:"03"==e.propertyCode?e.formFields2:e.formFields,commonData:e.selectSource}})],1),e._v(" "),a("div",{staticClass:"g-main-container-column"},[a("t8t-table",{ref:"t8ttable",attrs:{columns:"03"==e.propertyCode?e.mainTableColumns2:e.mainTableColumns,"edit-mode":e.editMode,service:e.mainTableService,method:e.mainTableMethod,commonData:e.commonData,args:e.args,indexCol:!1,pageBar:!0,editable:!0,templateData:e.templateData},on:{"cell-click":e.cellClick,"selection-change":e.selectionChange}})],1)])])]),e._v(" "),e.addGoodsDialogVisible?a("selectSkuGoodDialog",{attrs:{activeTableRef:e.activeTableRef,skuId:e.skuId,orgId:e.branchCompanyId,bomGdmId:e.bomGdmId},on:{close:e.closeSelectGoodsDialog,open:function(t){e.addGoodsDialogVisible}}}):e._e(),e._v(" "),e.addExpenseQuotaDialogVisible?a("selectExpenseQuotaDialog",{attrs:{activeTableRef:e.activeTableRef,skuId:e.skuId,orgId:this.headData.orgId,pkg:this.headData.pkgId,pkgTemp:this.headData.tempId,workType:this.headData.categoryId},on:{close:e.closeSelectGoodsDialog,open:function(t){e.addExpenseQuotaDialogVisible}}}):e._e()],1)},staticRenderFns:[]}},2434:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{staticClass:"g-w-1000 my-el-dialog selectQuoteItemdialog",attrs:{title:"选择SKU"},on:{close:e.closeSelectQuoteDialog},model:{value:e.addGoodsDialogVisible,callback:function(t){e.addGoodsDialogVisible=t}}},[a("t8t-search",{ref:"search",attrs:{fields:e.fields,selectSource:e.selectSource,showToggleBtn:!0},on:{submit:e.submitSearch}}),e._v(" "),a("el-row",{staticClass:"worker-sku-goods-contain",attrs:{gutter:20}},[a("el-col",{attrs:{span:5}},[a("el-tree",{ref:"treeselect",staticClass:"worker-sku-goods-tree",attrs:{data:e.treedata,"expand-on-click-node":!1,"highlight-current":!0,"default-expand-all":!0,props:e.defaultProps,accordion:""},on:{"node-click":e.handleNodeClick}})],1),e._v(" "),a("el-col",{attrs:{span:19}},[a("t8t-table",{ref:"t8ttable",staticStyle:{"min-height":"300px"},attrs:{columns:e.mainTableColumns,service:e.mainTableService,method:e.mainTableMethod,commonData:e.commonData,args:e.args,indexCol:!1,radioCol:!1,pageBar:!0,selectable:e.selectable},on:{"row-double-click":e.selectRow,"row-click":e.onRowClick,"selection-change":e.selectionChange}})],1)],1),e._v(" "),a("div",{slot:"footer"},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"grid-content"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.addGoodsDialogVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.submit()}}},[e._v("确认")])],1)])],1)],1)],1)],1)},staticRenderFns:[]}},2592:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{staticClass:"g-w-1000 my-el-dialog selectQuoteItemdialog",attrs:{title:"选择工费项"},on:{close:e.closeSelectQuoteDialog},model:{value:e.addGoodsDialogVisible,callback:function(t){e.addGoodsDialogVisible=t}}},[a("t8t-search",{ref:"search",attrs:{fields:e.fields,selectSource:e.selectSource,showToggleBtn:!0},on:{submit:e.submitSearch}}),e._v(" "),a("t8t-table",{ref:"t8ttable",staticStyle:{"min-height":"300px"},attrs:{columns:e.mainTableColumns,service:e.mainTableService,method:e.mainTableMethod,commonData:e.commonData,args:e.args,indexCol:!1,radioCol:!1,pageBar:!0,selectable:e.selectable},on:{"row-double-click":e.selectRow,"row-click":e.onRowClick,"selection-change":e.selectionChange}}),e._v(" "),a("div",{slot:"footer"},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"grid-content"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.addGoodsDialogVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.submit()}}},[e._v("确认")])],1)])],1)],1)],1)],1)},staticRenderFns:[]}}});